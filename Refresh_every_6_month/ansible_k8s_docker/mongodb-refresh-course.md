# MongoDB Refresh: Ğ•Ğ¶ĞµĞ³Ğ¾Ğ´Ğ½Ñ‹Ğ¹/ĞŸĞ¾Ğ»ÑƒĞ³Ğ¾Ğ´Ğ¾Ğ²Ğ¾Ğ¹ ĞºÑƒÑ€Ñ Ğ´Ğ»Ñ DevOps/SysAdmin

**Ğ¦ĞµĞ»ÑŒ:** ĞÑĞ²ĞµĞ¶Ğ¸Ñ‚ÑŒ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ğ¸ MongoDB Ğ·Ğ° 2-3 Ñ‡Ğ°ÑĞ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ Ğ¸ ÑƒĞ·Ğ½Ğ°Ñ‚ÑŒ 1-2 Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸.

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚:** ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ´ĞµĞ» ÑĞ¾ÑÑ‚Ğ¾Ğ¸Ñ‚ Ğ¸Ğ·:
1. **ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğ¹ Ñ‚ĞµĞ¾Ñ€Ğ¸Ğ¸ (ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°)**: Ğ¡Ğ°Ğ¼Ğ¾Ğµ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ·Ğ°Ğ±Ñ‹Ñ‚ÑŒ
2. **ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ**: Ğ ĞµĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€ÑƒÑ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ
3. **Ğ‘Ğ¾Ğ½ÑƒÑĞ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ (Ğ´Ğ»Ñ Ñ€Ğ¾ÑÑ‚Ğ°)**: Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ¿Ğ¾ÑĞ»Ğ¾Ğ¶Ğ½ĞµĞµ Ğ¸Ğ»Ğ¸ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ñ„Ğ¸Ñ‡Ğ¸

**ĞŸÑ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- MongoDB ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¸Ğ»Ğ¸ Docker)
- mongosh (MongoDB Shell) Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
- Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ JSON Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 1: Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° (20 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° MongoDB:**
```bash
# Docker (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
docker run --name mongodb -d \
  -p 27017:27017 \
  -e MONGO_INITDB_ROOT_USERNAME=admin \
  -e MONGO_INITDB_ROOT_PASSWORD=password123 \
  -v mongodb_data:/data/db \
  mongo:7.0

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Docker Compose
cat > docker-compose.yml <<EOF
version: '3.8'
services:
  mongodb:
    image: mongo:7.0
    container_name: mongodb
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: password123
    volumes:
      - mongodb_data:/data/db
    restart: unless-stopped

volumes:
  mongodb_data:
EOF

docker-compose up -d

# Linux (Ubuntu/Debian)
wget -qO - https://www.mongodb.org/static/pgp/server-7.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/7.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list
sudo apt update
sudo apt install -y mongodb-org
sudo systemctl start mongod
sudo systemctl enable mongod

# macOS
brew tap mongodb/brew
brew install mongodb-community@7.0
brew services start mongodb-community@7.0

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸
mongosh --version
```

**ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº MongoDB:**
```bash
# Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
mongosh

# Ğ¡ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
mongosh "mongodb://admin:password123@localhost:27017"

# Ğ¡ URI
mongosh "mongodb://admin:password123@localhost:27017/?authSource=admin"

# Ğš ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ½Ğ¾Ğ¼Ñƒ ÑĞµÑ€Ğ²ĞµÑ€Ñƒ
mongosh "mongodb://user:pass@host:27017/dbname"

# MongoDB Atlas
mongosh "mongodb+srv://cluster0.xxxxx.mongodb.net/mydb" --username user
```

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ mongosh:**
```javascript
// Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
show dbs                    // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ±Ğ°Ğ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
use mydb                    // ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ½Ğ° Ğ‘Ğ” (ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ ĞµÑĞ»Ğ¸ Ğ½ĞµÑ‚)
db                          // Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ‘Ğ”
show collections            // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹
db.dropDatabase()          // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ‘Ğ”

// ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
db.createCollection("users")
db.users.drop()            // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ
db.users.renameCollection("customers")

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
db.stats()
db.users.stats()

// ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ
help
db.help()
db.users.help()

// Ğ’Ñ‹Ñ…Ğ¾Ğ´
exit
```

**ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» MongoDB** (`/etc/mongod.conf`):
```yaml
# ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
storage:
  dbPath: /var/lib/mongodb
  journal:
    enabled: true
  engine: wiredTiger
  wiredTiger:
    engineConfig:
      cacheSizeGB: 1

systemLog:
  destination: file
  path: /var/log/mongodb/mongod.log
  logAppend: true
  logRotate: reopen

net:
  port: 27017
  bindIp: 127.0.0.1
  maxIncomingConnections: 1000

processManagement:
  timeZoneInfo: /usr/share/zoneinfo
  fork: true
  pidFilePath: /var/run/mongodb/mongod.pid

security:
  authorization: enabled
  javascriptEnabled: true

setParameter:
  enableLocalhostAuthBypass: false

operationProfiling:
  mode: slowOp
  slowOpThresholdMs: 100
```

**ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ:**
```bash
export MONGODB_URI="mongodb://admin:password123@localhost:27017"
export MONGODB_DATABASE="myapp"
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ:

1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ MongoDB Ñ‡ĞµÑ€ĞµĞ· Docker:
   ```bash
   docker run --name mongodb-test -d \
     -p 27017:27017 \
     -e MONGO_INITDB_ROOT_USERNAME=admin \
     -e MONGO_INITDB_ROOT_PASSWORD=password123 \
     mongo:7.0
   ```

2. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğº MongoDB:
   ```bash
   mongosh "mongodb://admin:password123@localhost:27017/?authSource=admin"
   ```

3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ‚ĞµÑÑ‚Ğ¾Ğ²ÑƒÑ Ğ±Ğ°Ğ·Ñƒ Ğ¸ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ:
   ```javascript
   use testdb
   db.createCollection("products")
   ```

4. Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
   ```javascript
   db.products.insertMany([
     { name: "Laptop", price: 1200, category: "Electronics", stock: 15 },
     { name: "Mouse", price: 25, category: "Electronics", stock: 150 },
     { name: "Desk", price: 300, category: "Furniture", stock: 30 }
   ])
   ```

5. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
   ```javascript
   db.products.find()
   db.products.countDocuments()
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ MongoDB Compass** (GUI Ğ´Ğ»Ñ MongoDB):
```bash
# Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ https://www.mongodb.com/products/compass
# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Homebrew Ğ½Ğ° macOS
brew install --cask mongodb-compass

# Connection string:
mongodb://admin:password123@localhost:27017/?authSource=admin
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ mongosh Ñ JavaScript Ñ„Ğ°Ğ¹Ğ»Ğ°Ğ¼Ğ¸:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ„Ğ°Ğ¹Ğ» seed.js
// seed.js
db = db.getSiblingDB('testdb');

db.products.drop();

db.products.insertMany([
  { name: "Laptop", price: 1200, category: "Electronics", stock: 15, tags: ["computer", "portable"] },
  { name: "Mouse", price: 25, category: "Electronics", stock: 150, tags: ["accessory"] },
  { name: "Desk", price: 300, category: "Furniture", stock: 30, tags: ["office"] },
  { name: "Chair", price: 200, category: "Furniture", stock: 45, tags: ["office", "ergonomic"] }
]);

print("Database seeded successfully!");
```

```bash
# Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚
mongosh "mongodb://admin:password123@localhost:27017/?authSource=admin" seed.js
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 2: CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Create (Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²):**
```javascript
// Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
db.users.insertOne({
  name: "John Doe",
  email: "john@example.com",
  age: 30,
  created_at: new Date()
})

// Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
db.users.insertMany([
  { name: "Alice", email: "alice@example.com", age: 25 },
  { name: "Bob", email: "bob@example.com", age: 35 }
])

// Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ñ _id
db.users.insertOne({
  _id: "user001",
  name: "Custom ID User"
})
```

**Read (Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²):**
```javascript
// Ğ’ÑĞµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹
db.users.find()

// Ğ¡ ÑƒÑĞ»Ğ¾Ğ²Ğ¸ĞµĞ¼
db.users.find({ age: 30 })
db.users.find({ age: { $gt: 25 } })  // Ğ±Ğ¾Ğ»ÑŒÑˆĞµ 25
db.users.find({ age: { $gte: 25 } }) // Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ¸Ğ»Ğ¸ Ñ€Ğ°Ğ²Ğ½Ğ¾
db.users.find({ age: { $lt: 35 } })  // Ğ¼ĞµĞ½ÑŒÑˆĞµ 35
db.users.find({ age: { $lte: 35 } }) // Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ¸Ğ»Ğ¸ Ñ€Ğ°Ğ²Ğ½Ğ¾
db.users.find({ age: { $ne: 30 } })  // Ğ½Ğµ Ñ€Ğ°Ğ²Ğ½Ğ¾ 30

// Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹
db.users.find({
  $and: [
    { age: { $gte: 25 } },
    { age: { $lte: 35 } }
  ]
})

db.users.find({
  $or: [
    { age: { $lt: 25 } },
    { age: { $gt: 35 } }
  ]
})

// ĞŸĞ¾Ğ¸ÑĞº Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²Ğµ
db.products.find({ tags: "computer" })
db.products.find({ tags: { $in: ["computer", "portable"] } })

// Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
db.users.find({ name: /^John/i })  // Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ñ John (case-insensitive)

// ĞŸÑ€Ğ¾ĞµĞºÑ†Ğ¸Ñ (Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ğ¾Ğ»ĞµĞ¹)
db.users.find({}, { name: 1, email: 1, _id: 0 })

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
db.users.find().sort({ age: 1 })   // Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°Ğ½Ğ¸Ñ
db.users.find().sort({ age: -1 })  // Ğ¿Ğ¾ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ

// Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Ğ¸ skip
db.users.find().limit(10)
db.users.find().skip(10).limit(10)  // Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ

// ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚
db.users.countDocuments()
db.users.countDocuments({ age: { $gt: 25 } })

// ĞĞ´Ğ¸Ğ½ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚
db.users.findOne({ email: "john@example.com" })
```

**Update (ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²):**
```javascript
// ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
db.users.updateOne(
  { email: "john@example.com" },
  { $set: { age: 31 } }
)

// ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
db.users.updateMany(
  { age: { $lt: 25 } },
  { $set: { status: "young" } }
)

// ĞĞ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
db.users.updateOne(
  { email: "john@example.com" },
  {
    $set: { age: 31 },              // ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
    $unset: { temp_field: "" },     // ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğµ
    $inc: { login_count: 1 },       // ÑƒĞ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ° 1
    $mul: { score: 1.1 },           // ÑƒĞ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ÑŒ Ğ½Ğ° 1.1
    $rename: { old_name: "new_name" }, // Ğ¿ĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğµ
    $currentDate: { last_modified: true }, // ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ğ´Ğ°Ñ‚Ñƒ
    $push: { tags: "new_tag" },     // Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²
    $pull: { tags: "old_tag" },     // ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸Ğ· Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°
    $addToSet: { tags: "unique_tag" } // Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞµÑĞ»Ğ¸ Ğ½ĞµÑ‚
  }
)

// Upsert (Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ° ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾)
db.users.updateOne(
  { email: "new@example.com" },
  { $set: { name: "New User", age: 28 } },
  { upsert: true }
)

// Replace (Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ·Ğ°Ğ¼ĞµĞ½Ğ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°)
db.users.replaceOne(
  { email: "john@example.com" },
  { name: "John Smith", email: "john@example.com", age: 32 }
)
```

**Delete (Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²):**
```javascript
// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
db.users.deleteOne({ email: "john@example.com" })

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
db.users.deleteMany({ age: { $lt: 18 } })

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
db.users.deleteMany({})
```

**ĞĞ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ
$eq    // Ñ€Ğ°Ğ²Ğ½Ğ¾
$ne    // Ğ½Ğµ Ñ€Ğ°Ğ²Ğ½Ğ¾
$gt    // Ğ±Ğ¾Ğ»ÑŒÑˆĞµ
$gte   // Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ¸Ğ»Ğ¸ Ñ€Ğ°Ğ²Ğ½Ğ¾
$lt    // Ğ¼ĞµĞ½ÑŒÑˆĞµ
$lte   // Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ¸Ğ»Ğ¸ Ñ€Ğ°Ğ²Ğ½Ğ¾
$in    // Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹
$nin   // Ğ½Ğµ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹

// Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ
$and   // Ğ˜
$or    // Ğ˜Ğ›Ğ˜
$not   // ĞĞ•
$nor   // ĞĞ˜ ... ĞĞ˜

// Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹
$exists // Ğ¿Ğ¾Ğ»Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
$type   // Ñ‚Ğ¸Ğ¿ Ğ¿Ğ¾Ğ»Ñ

// ĞœĞ°ÑÑĞ¸Ğ²Ñ‹
$all       // Ğ²ÑĞµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¿Ñ€Ğ¸ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‚
$elemMatch // Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ¸Ğ½ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚
$size      // Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹
db.products.find({ price: { $exists: true } })
db.products.find({ tags: { $all: ["computer", "portable"] } })
db.products.find({ tags: { $size: 2 } })
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸ĞµĞ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°Ğ¼Ğ¸:
   ```javascript
   use shop
   db.products.insertMany([
     { name: "iPhone 15", price: 999, category: "Electronics", stock: 50, tags: ["smartphone", "apple"], rating: 4.8 },
     { name: "Samsung Galaxy S24", price: 899, category: "Electronics", stock: 45, tags: ["smartphone", "samsung"], rating: 4.7 },
     { name: "MacBook Pro", price: 2499, category: "Computers", stock: 20, tags: ["laptop", "apple"], rating: 4.9 },
     { name: "Dell XPS 15", price: 1799, category: "Computers", stock: 30, tags: ["laptop", "dell"], rating: 4.6 },
     { name: "iPad Air", price: 599, category: "Tablets", stock: 60, tags: ["tablet", "apple"], rating: 4.7 }
   ])
   ```

2. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:
   ```javascript
   // ĞĞ°Ğ¹Ğ´Ğ¸ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ Ğ´Ğ¾Ñ€Ğ¾Ğ¶Ğµ $1000
   db.products.find({ price: { $gt: 1000 } })
   
   // ĞĞ°Ğ¹Ğ´Ğ¸ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ Apple
   db.products.find({ tags: "apple" })
   
   // ĞĞ°Ğ¹Ğ´Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Electronics Ñ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ğ¾Ğ¼ Ğ²Ñ‹ÑˆĞµ 4.7
   db.products.find({
     category: "Electronics",
     rating: { $gt: 4.7 }
   })
   
   // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ñ†ĞµĞ½Ñ‹ (Ğ±ĞµĞ· _id)
   db.products.find({}, { name: 1, price: 1, _id: 0 })
   
   // ĞĞ°Ğ¹Ğ´Ğ¸ 3 ÑĞ°Ğ¼Ñ‹Ñ… Ğ´Ğ¾Ñ€Ğ¾Ğ³Ğ¸Ñ… Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
   db.products.find().sort({ price: -1 }).limit(3)
   ```

3. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
   ```javascript
   // Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡ÑŒ Ñ†ĞµĞ½Ñƒ Ğ²ÑĞµÑ… Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Apple Ğ½Ğ° 10%
   db.products.updateMany(
     { tags: "apple" },
     { $mul: { price: 1.1 } }
   )
   
   // Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ¸ stock Ğ½Ğ° 1 Ğ´Ğ»Ñ iPhone 15
   db.products.updateOne(
     { name: "iPhone 15" },
     { $inc: { stock: -1 } }
   )
   
   // Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚ĞµĞ³ "premium" Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ´Ğ¾Ñ€Ğ¾Ğ¶Ğµ $1500
   db.products.updateMany(
     { price: { $gt: 1500 } },
     { $addToSet: { tags: "premium" } }
   )
   ```

4. Ğ£Ğ´Ğ°Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹:
   ```javascript
   // Ğ£Ğ´Ğ°Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ Ñ Ğ½ÑƒĞ»ĞµĞ²Ñ‹Ğ¼ stock (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
   db.products.deleteMany({ stock: 0 })
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Aggregation Pipeline Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ Ñ†ĞµĞ½Ğ° Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼
db.products.aggregate([
  {
    $group: {
      _id: "$category",
      avgPrice: { $avg: "$price" },
      totalStock: { $sum: "$stock" },
      count: { $sum: 1 }
    }
  },
  { $sort: { avgPrice: -1 } }
])

// ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹ Ñ Ñ†ĞµĞ½Ğ¾Ğ¹ Ğ²Ñ‹ÑˆĞµ ÑÑ€ĞµĞ´Ğ½ĞµĞ¹
db.products.aggregate([
  {
    $group: {
      _id: null,
      avgPrice: { $avg: "$price" }
    }
  },
  {
    $lookup: {
      from: "products",
      let: { avg: "$avgPrice" },
      pipeline: [
        { $match: { $expr: { $gt: ["$price", "$$avg"] } } }
      ],
      as: "expensive_products"
    }
  }
])
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Transaction Ğ´Ğ»Ñ Ğ°Ñ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹:**
```javascript
// Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ replica set
const session = db.getMongo().startSession()
session.startTransaction()

try {
  const productsCol = session.getDatabase("shop").products
  const ordersCol = session.getDatabase("shop").orders
  
  // Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ¸ stock
  productsCol.updateOne(
    { name: "iPhone 15" },
    { $inc: { stock: -1 } }
  )
  
  // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ·Ğ°ĞºĞ°Ğ·
  ordersCol.insertOne({
    product: "iPhone 15",
    quantity: 1,
    date: new Date()
  })
  
  session.commitTransaction()
} catch (error) {
  session.abortTransaction()
  print("Transaction aborted: " + error)
} finally {
  session.endSession()
}
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 3: Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (30 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ² MongoDB:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
db.users.createIndex({ email: 1 })        // ĞŸĞ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°Ğ½Ğ¸Ñ
db.users.createIndex({ age: -1 })         // ĞŸĞ¾ ÑƒĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
db.users.createIndex({ email: 1, age: 1 }) // Ğ¡Ğ¾ÑÑ‚Ğ°Ğ²Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ

// Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ
db.users.createIndex({ email: 1 }, { unique: true })

// Partial index (Ğ¸Ğ½Ğ´ĞµĞºÑ Ñ ÑƒÑĞ»Ğ¾Ğ²Ğ¸ĞµĞ¼)
db.users.createIndex(
  { email: 1 },
  { partialFilterExpression: { age: { $gte: 18 } } }
)

// TTL Ğ¸Ğ½Ğ´ĞµĞºÑ (Ğ°Ğ²Ñ‚Ğ¾ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ)
db.sessions.createIndex(
  { created_at: 1 },
  { expireAfterSeconds: 3600 }  // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· 1 Ñ‡Ğ°Ñ
)

// Text Ğ¸Ğ½Ğ´ĞµĞºÑ (Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº)
db.articles.createIndex({ title: "text", content: "text" })

// Geospatial Ğ¸Ğ½Ğ´ĞµĞºÑ
db.places.createIndex({ location: "2dsphere" })

// ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
db.users.getIndexes()

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
db.users.dropIndex("email_1")
db.users.dropIndexes()  // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ ĞºÑ€Ğ¾Ğ¼Ğµ _id

// Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ± Ğ¸Ğ½Ğ´ĞµĞºÑĞµ
db.users.getIndexes()
db.users.totalIndexSize()
```

**Explain - Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ explain
db.users.find({ email: "john@example.com" }).explain()

// Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ explain
db.users.find({ email: "john@example.com" }).explain("executionStats")

// ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ explain
db.users.find({ email: "john@example.com" }).explain("allPlansExecution")

// Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸:
// - executionTimeMillis: Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
// - totalDocsExamined: Ğ¿Ñ€Ğ¾ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
// - totalKeysExamined: Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ ĞºĞ»ÑÑ‡ĞµĞ¹ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°
// - stage: IXSCAN (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½ Ğ¸Ğ½Ğ´ĞµĞºÑ) Ğ¸Ğ»Ğ¸ COLLSCAN (ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸)
```

**ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
db.users.find({ age: 30 }).explain("executionStats")
// stage: "COLLSCAN" - Ğ¿Ğ»Ğ¾Ñ…Ğ¾

// Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¸Ğ½Ğ´ĞµĞºÑ
db.users.createIndex({ age: 1 })
db.users.find({ age: 30 }).explain("executionStats")
// stage: "IXSCAN" - Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾

// ĞŸĞ¾ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ (Covered Query)
db.users.createIndex({ email: 1, name: 1 })
db.users.find(
  { email: "john@example.com" },
  { email: 1, name: 1, _id: 0 }
).explain("executionStats")
// totalDocsExamined: 0 - Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾!
```

**ĞŸÑ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€ MongoDB:**
```javascript
// Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€
db.setProfilingLevel(2)  // 0=off, 1=slow ops, 2=all ops

// ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
db.system.profile.find().sort({ ts: -1 }).limit(5)

// ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ñ ÑƒÑĞ»Ğ¾Ğ²Ğ¸ĞµĞ¼
db.system.profile.find({
  millis: { $gt: 100 }
}).sort({ millis: -1 })

// Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€
db.setProfilingLevel(0)
```

**CurrentOp - Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸:**
```javascript
// Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
db.currentOp()

// ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
db.currentOp({ "secs_running": { $gt: 5 } })

// Ğ£Ğ±Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ
db.killOp(opid)
```

**Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹:**
```javascript
// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
db.users.stats()

// Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
db.users.dataSize()
db.users.storageSize()
db.users.totalIndexSize()

// ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
db.users.countDocuments()
db.users.estimatedDocumentCount()  // Ğ‘Ñ‹ÑÑ‚Ñ€ĞµĞµ, Ğ½Ğ¾ Ğ¿Ñ€Ğ¸Ğ±Ğ»Ğ¸Ğ·Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ‚ĞµÑÑ‚Ğ¾Ğ²ÑƒÑ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾Ğ¼ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²:
   ```javascript
   use performance_test
   
   // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   function generateUsers(count) {
     let users = [];
     for (let i = 0; i < count; i++) {
       users.push({
         email: `user${i}@example.com`,
         name: `User ${i}`,
         age: 18 + Math.floor(Math.random() * 50),
         city: ["New York", "London", "Tokyo", "Paris", "Berlin"][Math.floor(Math.random() * 5)],
         created_at: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000)
       });
       
       if (users.length >= 1000) {
         db.users.insertMany(users);
         users = [];
       }
     }
     if (users.length > 0) {
       db.users.insertMany(users);
     }
   }
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ 10000 Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
   generateUsers(10000)
   ```

2. ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ±ĞµĞ· Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²:
   ```javascript
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
   db.users.find({ email: "user5000@example.com" }).explain("executionStats")
   // ĞĞ±Ñ€Ğ°Ñ‚Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° executionTimeMillis Ğ¸ totalDocsExamined
   
   db.users.find({ age: { $gte: 30, $lte: 40 } }).explain("executionStats")
   ```

3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:
   ```javascript
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ½Ğ° email
   db.users.createIndex({ email: 1 })
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑĞ½Ğ¾Ğ²Ğ°
   db.users.find({ email: "user5000@example.com" }).explain("executionStats")
   // Ğ”Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ IXSCAN
   
   // Ğ¡Ğ¾ÑÑ‚Ğ°Ğ²Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ
   db.users.createIndex({ city: 1, age: 1 })
   
   // Ğ¢ĞµÑÑ‚ ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°
   db.users.find({
     city: "Tokyo",
     age: { $gte: 30 }
   }).explain("executionStats")
   ```

4. ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²:
   ```javascript
   // Ğ’ÑĞµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
   db.users.getIndexes()
   
   // Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
   db.users.totalIndexSize()
   
   // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
   db.users.aggregate([
     { $indexStats: {} }
   ])
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ hint() Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°:**
```javascript
// ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ
db.users.find({
  city: "Tokyo",
  age: { $gte: 30 }
}).hint({ city: 1, age: 1 }).explain("executionStats")

// ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ (Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
db.users.find({ email: "user5000@example.com" }).hint({ $natural: 1 })
```

**Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ wildcard Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ğ³Ğ¸Ğ±ĞºĞ¸Ñ… ÑÑ…ĞµĞ¼:**
```javascript
// Ğ˜Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ĞµĞ¹
db.flexible.createIndex({ "$**": 1 })

// Wildcard Ğ¸Ğ½Ğ´ĞµĞºÑ Ñ ÑƒÑĞ»Ğ¾Ğ²Ğ¸ĞµĞ¼
db.flexible.createIndex(
  { "metadata.$**": 1 },
  { wildcardProjection: { "metadata.internal": 0 } }
)
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ $indexStats Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:**
```javascript
// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
db.users.aggregate([
  { $indexStats: {} },
  { $sort: { "accesses.ops": -1 } }
])

// ĞĞ°Ğ¹Ğ´Ğ¸ Ğ½ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
db.users.aggregate([
  { $indexStats: {} },
  { $match: { "accesses.ops": 0 } }
])
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 4: ĞĞ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ (Aggregation Pipeline) (30 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Aggregation Pipeline - Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ÑÑ‚Ğ°Ğ´Ğ¸Ğ¸:**
```javascript
// $match - Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ (ĞºĞ°Ğº find)
db.orders.aggregate([
  { $match: { status: "completed" } }
])

// $project - Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¸ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ĞµĞ¹
db.orders.aggregate([
  {
    $project: {
      order_id: "$_id",
      total: 1,
      _id: 0
    }
  }
])

// $group - Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
db.orders.aggregate([
  {
    $group: {
      _id: "$customer_id",
      totalSpent: { $sum: "$total" },
      orderCount: { $sum: 1 },
      avgOrder: { $avg: "$total" }
    }
  }
])

// $sort - ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
db.orders.aggregate([
  { $sort: { total: -1 } }
])

// $limit Ğ¸ $skip - Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ
db.orders.aggregate([
  { $sort: { total: -1 } },
  { $skip: 10 },
  { $limit: 10 }
])

// $lookup - JOIN (ÑĞ²ÑĞ·ÑŒ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹)
db.orders.aggregate([
  {
    $lookup: {
      from: "customers",
      localField: "customer_id",
      foreignField: "_id",
      as: "customer"
    }
  }
])

// $unwind - Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¼Ğ°ÑÑĞ¸Ğ²
db.orders.aggregate([
  { $unwind: "$items" }
])

// $addFields - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ñ
db.orders.aggregate([
  {
    $addFields: {
      totalWithTax: { $multiply: ["$total", 1.2] }
    }
  }
])

// $bucket - Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ°Ğ¼
db.products.aggregate([
  {
    $bucket: {
      groupBy: "$price",
      boundaries: [0, 100, 500, 1000, 5000],
      default: "5000+",
      output: {
        count: { $sum: 1 },
        products: { $push: "$name" }
      }
    }
  }
])
```

**ĞĞ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¸:**
```javascript
// ĞÑ€Ğ¸Ñ„Ğ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ
$add, $subtract, $multiply, $divide, $mod

// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ
$eq, $ne, $gt, $gte, $lt, $lte

// Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ
$and, $or, $not

// ĞœĞ°ÑÑĞ¸Ğ²Ñ‹
$size, $arrayElemAt, $slice, $concatArrays, $filter

// Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ¸
$concat, $substr, $toLower, $toUpper, $split

// Ğ”Ğ°Ñ‚Ñ‹
$year, $month, $dayOfMonth, $hour, $minute, $dateToString

// Ğ£ÑĞ»Ğ¾Ğ²Ğ½Ñ‹Ğµ
$cond, $ifNull, $switch

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
db.orders.aggregate([
  {
    $project: {
      year: { $year: "$order_date" },
      month: { $month: "$order_date" },
      isExpensive: {
        $cond: {
          if: { $gte: ["$total", 1000] },
          then: "yes",
          else: "no"
        }
      }
    }
  }
])
```

**Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¸:**
```javascript
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶
db.orders.aggregate([
  // 1. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ³Ğ¾Ğ´Ñƒ
  {
    $match: {
      order_date: {
        $gte: new Date("2024-01-01"),
        $lt: new Date("2025-01-01")
      }
    }
  },
  // 2. Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ items
  { $unwind: "$items" },
  // 3. JOIN Ñ products
  {
    $lookup: {
      from: "products",
      localField: "items.product_id",
      foreignField: "_id",
      as: "product_info"
    }
  },
  // 4. Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼
  {
    $group: {
      _id: "$product_info.category",
      totalRevenue: { $sum: { $multiply: ["$items.quantity", "$items.price"] } },
      orderCount: { $sum: 1 },
      avgOrderValue: { $avg: "$total" }
    }
  },
  // 5. Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ²Ñ‹Ñ€ÑƒÑ‡ĞºĞµ
  { $sort: { totalRevenue: -1 } },
  // 6. Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°
  {
    $project: {
      category: "$_id",
      revenue: { $round: ["$totalRevenue", 2] },
      orders: "$orderCount",
      avgOrder: { $round: ["$avgOrderValue", 2] },
      _id: 0
    }
  }
])
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸ Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸:
   ```javascript
   use ecommerce
   
   // ĞšĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹
   db.customers.insertMany([
     { _id: 1, name: "Alice Johnson", email: "alice@example.com", city: "New York" },
     { _id: 2, name: "Bob Smith", email: "bob@example.com", city: "London" },
     { _id: 3, name: "Charlie Brown", email: "charlie@example.com", city: "Tokyo" }
   ])
   
   // ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹
   db.products.insertMany([
     { _id: 101, name: "Laptop", price: 1200, category: "Electronics" },
     { _id: 102, name: "Mouse", price: 25, category: "Electronics" },
     { _id: 103, name: "Desk", price: 300, category: "Furniture" },
     { _id: 104, name: "Chair", price: 200, category: "Furniture" },
     { _id: 105, name: "Monitor", price: 400, category: "Electronics" }
   ])
   
   // Ğ—Ğ°ĞºĞ°Ğ·Ñ‹
   db.orders.insertMany([
     {
       _id: 1001,
       customer_id: 1,
       order_date: new Date("2024-01-15"),
       status: "completed",
       items: [
         { product_id: 101, quantity: 1, price: 1200 },
         { product_id: 102, quantity: 2, price: 25 }
       ]
     },
     {
       _id: 1002,
       customer_id: 2,
       order_date: new Date("2024-02-20"),
       status: "completed",
       items: [
         { product_id: 103, quantity: 1, price: 300 },
         { product_id: 104, quantity: 2, price: 200 }
       ]
     },
     {
       _id: 1003,
       customer_id: 3,
       order_date: new Date("2024-03-10"),
       status: "completed",
       items: [
         { product_id: 105, quantity: 1, price: 400 },
         { product_id: 102, quantity: 1, price: 25 }
       ]
     },
     {
       _id: 1004,
       customer_id: 1,
       order_date: new Date("2024-04-05"),
       status: "pending",
       items: [
         { product_id: 104, quantity: 1, price: 200 }
       ]
     }
   ])
   ```

2. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¸:
   ```javascript
   // ĞĞ±Ñ‰Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ° Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñƒ
   db.orders.aggregate([
     { $match: { status: "completed" } },
     { $unwind: "$items" },
     {
       $group: {
         _id: "$customer_id",
         totalSpent: { $sum: { $multiply: ["$items.quantity", "$items.price"] } },
         orderCount: { $sum: 1 }
       }
     },
     { $sort: { totalSpent: -1 } }
   ])
   
   // Ğ¡Ğ°Ğ¼Ñ‹Ğµ Ğ¿Ğ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹
   db.orders.aggregate([
     { $unwind: "$items" },
     {
       $group: {
         _id: "$items.product_id",
         totalQuantity: { $sum: "$items.quantity" },
         revenue: { $sum: { $multiply: ["$items.quantity", "$items.price"] } }
       }
     },
     { $sort: { totalQuantity: -1 } },
     {
       $lookup: {
         from: "products",
         localField: "_id",
         foreignField: "_id",
         as: "product"
       }
     },
     { $unwind: "$product" },
     {
       $project: {
         product_name: "$product.name",
         quantity_sold: "$totalQuantity",
         revenue: 1,
         _id: 0
       }
     }
   ])
   ```

3. Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ°Ñ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ - Ğ¾Ñ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ°Ğ¼:
   ```javascript
   // ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼ Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼Ğ¸ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
   db.orders.aggregate([
     { $match: { status: "completed" } },
     { $unwind: "$items" },
     {
       $lookup: {
         from: "products",
         localField: "items.product_id",
         foreignField: "_id",
         as: "product"
       }
     },
     { $unwind: "$product" },
     {
       $lookup: {
         from: "customers",
         localField: "customer_id",
         foreignField: "_id",
         as: "customer"
       }
     },
     { $unwind: "$customer" },
     {
       $group: {
         _id: {
           category: "$product.category",
           city: "$customer.city"
         },
         revenue: { $sum: { $multiply: ["$items.quantity", "$items.price"] } },
         orders: { $sum: 1 },
         unique_customers: { $addToSet: "$customer_id" }
       }
     },
     {
       $project: {
         category: "$_id.category",
         city: "$_id.city",
         revenue: 1,
         orders: 1,
         customer_count: { $size: "$unique_customers" },
         _id: 0
       }
     },
     { $sort: { revenue: -1 } }
   ])
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ $facet Ğ´Ğ»Ñ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¹:**
```javascript
// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² Ğ·Ğ° Ğ¾Ğ´Ğ¸Ğ½ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
db.orders.aggregate([
  {
    $facet: {
      // ĞÑ‚Ñ‡ĞµÑ‚ 1: Ğ¿Ğ¾ Ğ¼ĞµÑÑÑ†Ğ°Ğ¼
      byMonth: [
        {
          $group: {
            _id: { $month: "$order_date" },
            orders: { $sum: 1 }
          }
        },
        { $sort: { _id: 1 } }
      ],
      // ĞÑ‚Ñ‡ĞµÑ‚ 2: Ğ¿Ğ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°Ğ¼
      byStatus: [
        {
          $group: {
            _id: "$status",
            count: { $sum: 1 }
          }
        }
      ],
      // ĞÑ‚Ñ‡ĞµÑ‚ 3: Ñ‚Ğ¾Ğ¿ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
      topCustomers: [
        { $unwind: "$items" },
        {
          $group: {
            _id: "$customer_id",
            total: { $sum: { $multiply: ["$items.quantity", "$items.price"] } }
          }
        },
        { $sort: { total: -1 } },
        { $limit: 3 }
      ]
    }
  }
])
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ $graphLookup Ğ´Ğ»Ñ Ñ€ĞµĞºÑƒÑ€ÑĞ¸Ğ²Ğ½Ñ‹Ñ… ÑĞ²ÑĞ·ĞµĞ¹:**
```javascript
// Ğ”Ğ»Ñ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ñ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼Ğ¸)
db.categories.aggregate([
  {
    $graphLookup: {
      from: "categories",
      startWith: "$_id",
      connectFromField: "_id",
      connectToField: "parent_id",
      as: "subcategories",
      maxDepth: 3
    }
  }
])
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 5: Ğ ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸ Ğ¾Ñ‚ĞºĞ°Ğ·Ğ¾ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Replica Set - Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ğ¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Replica Set                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Replication  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Primary  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚Secondaryâ”‚â”‚
â”‚  â”‚  (r/w)   â”‚               â”‚  (r)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                          â”‚      â”‚
â”‚       â”‚    Election              â”‚      â”‚
â”‚       â–¼                          â–¼      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Secondaryâ”‚                â”‚Secondaryâ”‚â”‚
â”‚  â”‚  (r)   â”‚                â”‚  (r)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Replica Set (Docker Compose):**
```yaml
# docker-compose-replica.yml
version: '3.8'

services:
  mongo1:
    image: mongo:7.0
    container_name: mongo1
    command: mongod --replSet rs0 --port 27017
    ports:
      - "27017:27017"
    volumes:
      - mongo1_data:/data/db
    networks:
      - mongo_cluster

  mongo2:
    image: mongo:7.0
    container_name: mongo2
    command: mongod --replSet rs0 --port 27017
    ports:
      - "27018:27017"
    volumes:
      - mongo2_data:/data/db
    networks:
      - mongo_cluster

  mongo3:
    image: mongo:7.0
    container_name: mongo3
    command: mongod --replSet rs0 --port 27017
    ports:
      - "27019:27017"
    volumes:
      - mongo3_data:/data/db
    networks:
      - mongo_cluster

volumes:
  mongo1_data:
  mongo2_data:
  mongo3_data:

networks:
  mongo_cluster:
    driver: bridge
```

**Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Replica Set:**
```javascript
// ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğº Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼Ñƒ ÑƒĞ·Ğ»Ñƒ
mongosh --port 27017

// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ replica set
rs.initiate({
  _id: "rs0",
  members: [
    { _id: 0, host: "mongo1:27017" },
    { _id: 1, host: "mongo2:27017" },
    { _id: 2, host: "mongo3:27017" }
  ]
})

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
rs.status()

// ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
rs.conf()

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
rs.printReplicationInfo()
rs.printSecondaryReplicationInfo()
```

**Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Replica Set:**
```javascript
// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒĞ·ĞµĞ»
rs.add("mongo4:27017")

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ arbiter (Ğ³Ğ¾Ğ»Ğ¾ÑÑƒÑÑ‰Ğ¸Ğ¹ ÑƒĞ·ĞµĞ» Ğ±ĞµĞ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
rs.addArb("mongo-arbiter:27017")

// Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑƒĞ·ĞµĞ»
rs.remove("mongo4:27017")

// Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ ÑƒĞ·Ğ»Ğ°
cfg = rs.conf()
cfg.members[1].priority = 2  // Ğ’Ñ‹ÑˆĞµ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ²
rs.reconfig(cfg)

// ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ°Ñ ÑĞ¼ĞµĞ½Ğ° Primary
rs.stepDown()

// Ğ—Ğ°Ğ¼Ğ¾Ñ€Ğ¾Ğ·Ğ¸Ñ‚ÑŒ Secondary (Ğ½Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ² Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ°Ñ…)
rs.freeze(120)  // 120 ÑĞµĞºÑƒĞ½Ğ´
```

**Read Preferences:**
```javascript
// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ Primary (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
db.users.find().readPref("primary")

// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ Primary Ğ¸Ğ»Ğ¸ Secondary
db.users.find().readPref("primaryPreferred")

// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ Secondary
db.users.find().readPref("secondary")

// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ Secondary Ğ¸Ğ»Ğ¸ Primary
db.users.find().readPref("secondaryPreferred")

// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ñ Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞµĞ³Ğ¾ ÑƒĞ·Ğ»Ğ°
db.users.find().readPref("nearest")

// Ğ’ URI
mongodb://host1,host2,host3/?replicaSet=rs0&readPreference=secondaryPreferred
```

**Write Concerns:**
```javascript
// Write concern - Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
db.users.insertOne(
  { name: "John" },
  { writeConcern: { w: "majority", j: true, wtimeout: 5000 } }
)

// w: "majority" - Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ½ÑÑ‚Ğ²Ğ¾ ÑƒĞ·Ğ»Ğ¾Ğ² Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ğ»Ğ¾
// j: true - Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ¾ Ğ² journal
// wtimeout: Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ

// Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ w:
// w: 0 - Ğ½Ğµ Ğ¶Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ
// w: 1 - Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ primary
// w: 2 - Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ primary + 1 secondary
// w: "majority" - Ğ¾Ñ‚ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ½ÑÑ‚Ğ²Ğ° ÑƒĞ·Ğ»Ğ¾Ğ²
```

**ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:**
```javascript
// Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
rs.status()

// Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
rs.printSecondaryReplicationInfo()

// Ğ¯Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ»Ğ¸ ÑƒĞ·ĞµĞ» Primary
db.isMaster()

// Oplog Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ
db.getReplicationInfo()

// Ğ Ğ°Ğ·Ğ¼ĞµÑ€ oplog
db.oplog.rs.stats()
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Replica Set:

1. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ Replica Set Ñ‡ĞµÑ€ĞµĞ· Docker Compose:
   ```bash
   # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ docker-compose-replica.yml (ÑĞ¼. Ğ²Ñ‹ÑˆĞµ)
   docker-compose -f docker-compose-replica.yml up -d
   
   # ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸ 10-15 ÑĞµĞºÑƒĞ½Ğ´ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
   sleep 15
   ```

2. Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Replica Set:
   ```bash
   mongosh --port 27017
   ```
   
   ```javascript
   rs.initiate({
     _id: "rs0",
     members: [
       { _id: 0, host: "localhost:27017" },
       { _id: 1, host: "localhost:27018" },
       { _id: 2, host: "localhost:27019" }
     ]
   })
   
   // ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸ ~30 ÑĞµĞºÑƒĞ½Ğ´
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
   rs.status()
   ```

3. ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ:
   ```javascript
   // ĞĞ° Primary ÑĞ¾Ğ·Ğ´Ğ°Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   use testdb
   db.replication_test.insertOne({ 
     message: "Hello from Primary",
     timestamp: new Date()
   })
   
   // ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğº Secondary
   // mongosh --port 27018
   // Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ñ Secondary
   db.getMongo().setReadPref("secondary")
   
   use testdb
   db.replication_test.find()
   // Ğ”Ğ¾Ğ»Ğ¶ĞµĞ½ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   ```

4. ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹ Ğ¾Ñ‚ĞºĞ°Ğ·Ğ¾ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ:
   ```bash
   # ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ Primary
   docker stop mongo1
   
   # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğº Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼Ñƒ ÑƒĞ·Ğ»Ñƒ
   mongosh --port 27018
   
   # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ, Ñ‡Ñ‚Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Primary Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½
   rs.status()
   
   # Ğ—Ğ°Ğ¿Ğ¸ÑˆĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   db.replication_test.insertOne({ 
     message: "New Primary is working",
     timestamp: new Date()
   })
   
   # Ğ’ĞµÑ€Ğ½Ğ¸ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑƒĞ·ĞµĞ»
   docker start mongo1
   
   # ĞĞ½ ÑÑ‚Ğ°Ğ½ĞµÑ‚ Secondary Ğ¸ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Read Concern Ğ´Ğ»Ñ ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾Ğ¹ ĞºĞ¾Ğ½ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸:**
```javascript
// Linearizable read - ÑÑ‚Ñ€Ğ¾Ğ¶Ğ°Ğ¹ÑˆĞ°Ñ ĞºĞ¾Ğ½ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ
db.users.find({ _id: 123 }).readConcern("linearizable")

// Majority - Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ½Ğ¾ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ½ÑÑ‚Ğ²Ğ¾Ğ¼ ÑƒĞ·Ğ»Ğ¾Ğ²
db.users.find().readConcern("majority")

// ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ write Ğ¸ read concern
db.users.insertOne(
  { name: "John" },
  { 
    writeConcern: { w: "majority" },
    readConcern: { level: "majority" }
  }
)
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Casual Consistency Ğ´Ğ»Ñ ÑĞµÑÑĞ¸Ğ¹:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑĞµÑÑĞ¸Ñ Ñ causal consistency
const session = db.getMongo().startSession({
  causalConsistency: true
})

const sessionDB = session.getDatabase("testdb")

// Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ
sessionDB.users.insertOne({ name: "Alice" })

// Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ ÑƒĞ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ´Ğ°Ğ¶Ğµ Ğ½Ğ° Secondary
sessionDB.users.findOne({ name: "Alice" })

session.endSession()
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 6: Ğ¨Ğ°Ñ€Ğ´Ğ¸Ğ½Ğ³ Ğ¸ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (30 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Sharding - Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Sharded Cluster                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Query    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  mongos  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  mongos  â”‚        â”‚
â”‚  â”‚ (Router) â”‚           â”‚ (Router) â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚        â”‚                     â”‚               â”‚
â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚               â”‚
â”‚        â””â”€â”€â”€â–ºâ”‚ Config Server â”‚â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚             â”‚  Replica Set  â”‚                â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                     â”‚                        â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚        â–¼            â–¼            â–¼           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚ Shard1 â”‚   â”‚ Shard2 â”‚   â”‚ Shard3 â”‚      â”‚
â”‚   â”‚  RS1   â”‚   â”‚  RS2   â”‚   â”‚  RS3   â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Sharding (Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ):**
```bash
# 1. Config Server Replica Set
mongod --configsvr --replSet configRS --port 27019 --dbpath /data/configdb

# 2. Shard Replica Sets
mongod --shardsvr --replSet shard1RS --port 27018 --dbpath /data/shard1
mongod --shardsvr --replSet shard2RS --port 27028 --dbpath /data/shard2

# 3. mongos Router
mongos --configdb configRS/localhost:27019 --port 27017
```

**Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³Ğ°:**
```javascript
// ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğº mongos
mongosh --port 27017

// Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ ÑˆĞ°Ñ€Ğ´Ñ‹
sh.addShard("shard1RS/localhost:27018")
sh.addShard("shard2RS/localhost:27028")

// Ğ’ĞºĞ»ÑÑ‡Ğ¸ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³ Ğ´Ğ»Ñ Ğ‘Ğ”
sh.enableSharding("mydb")

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ shard key
db.users.createIndex({ user_id: 1 })

// Ğ—Ğ°ÑˆĞ°Ñ€Ğ´Ğ¸Ñ€ÑƒĞ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ
sh.shardCollection("mydb.users", { user_id: 1 })

// Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³Ğ°
sh.status()
```

**Shard Key - ĞºĞ»ÑÑ‡ ÑˆĞ°Ñ€Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
```javascript
// Ranged sharding (Ğ¿Ğ¾ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ°Ğ¼)
sh.shardCollection("mydb.users", { age: 1 })

// Hashed sharding (Ñ…ÑÑˆ, Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ¾Ğµ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ)
sh.shardCollection("mydb.logs", { _id: "hashed" })

// Compound shard key
sh.shardCollection("mydb.orders", { customer_id: 1, order_date: 1 })

// Zone sharding (Ğ³ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ)
sh.addShardToZone("shard1RS", "US")
sh.addShardToZone("shard2RS", "EU")

sh.updateZoneKeyRange(
  "mydb.users",
  { country: "US" },
  { country: "US\uffff" },
  "US"
)
```

**Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ chunks:**
```javascript
// Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ chunks
db.printShardingStatus()

// Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ chunk
sh.splitAt("mydb.users", { user_id: 10000 })

// Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ chunks
sh.enableBalancing("mydb.users")
sh.disableBalancing("mydb.users")

// Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞµÑ€Ğ°
sh.getBalancerState()
sh.isBalancerRunning()

// ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾ĞºĞ½Ğ° Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸
db.settings.update(
  { _id: "balancer" },
  { $set: { activeWindow: { start: "23:00", stop: "06:00" } } },
  { upsert: true }
)
```

**ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³Ğ°:**
```javascript
// ĞĞ±Ñ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ
sh.status()

// Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
db.users.getShardDistribution()

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ÑˆĞ°Ñ€Ğ´Ğ°Ğ¼
db.stats()

// ĞšĞ°ĞºĞ¸Ğµ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸ Ğ·Ğ°ÑˆĞ°Ñ€Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹
use config
db.collections.find()

// Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ chunks
db.chunks.find({ ns: "mydb.users" }).count()
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ ÑˆĞ°Ñ€Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½ÑƒÑ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸):
   ```bash
   # Ğ’ production Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ replica sets Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°!
   # Ğ­Ñ‚Ğ¾ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
   
   # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸
   mkdir -p /tmp/mongodb/{config,shard1,shard2}
   
   # Config Server
   mongod --configsvr --replSet configRS \
     --port 27019 --dbpath /tmp/mongodb/config \
     --logpath /tmp/mongodb/config.log --fork
   
   # Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ config RS
   mongosh --port 27019
   ```
   
   ```javascript
   rs.initiate({
     _id: "configRS",
     configsvr: true,
     members: [{ _id: 0, host: "localhost:27019" }]
   })
   exit
   ```

2. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ ÑˆĞ°Ñ€Ğ´Ñ‹:
   ```bash
   # Shard 1
   mongod --shardsvr --replSet shard1RS \
     --port 27018 --dbpath /tmp/mongodb/shard1 \
     --logpath /tmp/mongodb/shard1.log --fork
   
   # Shard 2
   mongod --shardsvr --replSet shard2RS \
     --port 27028 --dbpath /tmp/mongodb/shard2 \
     --logpath /tmp/mongodb/shard2.log --fork
   
   # Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ shard RS
   mongosh --port 27018
   ```
   
   ```javascript
   rs.initiate({
     _id: "shard1RS",
     members: [{ _id: 0, host: "localhost:27018" }]
   })
   exit
   ```
   
   ```bash
   mongosh --port 27028
   ```
   
   ```javascript
   rs.initiate({
     _id: "shard2RS",
     members: [{ _id: 0, host: "localhost:27028" }]
   })
   exit
   ```

3. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ mongos router:
   ```bash
   mongos --configdb configRS/localhost:27019 \
     --port 27017 --logpath /tmp/mongodb/mongos.log --fork
   ```

4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³:
   ```bash
   mongosh --port 27017
   ```
   
   ```javascript
   // Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ ÑˆĞ°Ñ€Ğ´Ñ‹
   sh.addShard("shard1RS/localhost:27018")
   sh.addShard("shard2RS/localhost:27028")
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
   sh.status()
   
   // Ğ’ĞºĞ»ÑÑ‡Ğ¸ ÑˆĞ°Ñ€Ğ´Ğ¸Ğ½Ğ³ Ğ´Ğ»Ñ Ğ‘Ğ”
   sh.enableSharding("testdb")
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
   use testdb
   for(let i = 0; i < 10000; i++) {
     db.users.insertOne({
       user_id: i,
       name: "User " + i,
       created_at: new Date()
     })
   }
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ
   db.users.createIndex({ user_id: 1 })
   
   // Ğ—Ğ°ÑˆĞ°Ñ€Ğ´Ğ¸Ñ€ÑƒĞ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ (hashed Ğ´Ğ»Ñ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ)
   sh.shardCollection("testdb.users", { user_id: "hashed" })
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ
   db.users.getShardDistribution()
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Zone Sharding Ğ´Ğ»Ñ Ğ³ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ·Ğ¾Ğ½Ñ‹
sh.addShardToZone("shard1RS", "US_EAST")
sh.addShardToZone("shard2RS", "EU_WEST")

// ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñ‹ Ğ´Ğ»Ñ Ğ·Ğ¾Ğ½
sh.updateZoneKeyRange(
  "testdb.users",
  { user_id: MinKey },
  { user_id: 5000 },
  "US_EAST"
)

sh.updateZoneKeyRange(
  "testdb.users",
  { user_id: 5000 },
  { user_id: MaxKey },
  "EU_WEST"
)

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ·Ğ¾Ğ½Ñ‹
sh.status()
```

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Jumbo Chunks Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ:**
```javascript
// Ğ”Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… chunks, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ½Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¸Ñ€ÑƒÑÑ‚ÑÑ
db.adminCommand({
  splitChunk: "testdb.users",
  keyPattern: { user_id: 1 },
  bounds: [{ user_id: MinKey }, { user_id: 5000 }]
})

// ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ chunk
db.adminCommand({
  moveChunk: "testdb.users",
  find: { user_id: 1000 },
  to: "shard2RS"
})
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 7: Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°
use admin
db.createUser({
  user: "admin",
  pwd: "SecurePassword123!",
  roles: [{ role: "userAdminAnyDatabase", db: "admin" }]
})

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ‘Ğ”
use myapp
db.createUser({
  user: "app_user",
  pwd: "AppPassword123!",
  roles: [
    { role: "readWrite", db: "myapp" },
    { role: "read", db: "analytics" }
  ]
})

// Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ñ€Ğ¾Ğ»Ğ¸
// read - Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ
// readWrite - Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ
// dbAdmin - Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ‘Ğ”
// userAdmin - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸
// clusterAdmin - Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°
// root - Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿

// Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸
db.getUsers()
db.getUser("app_user")
db.dropUser("app_user")

// Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
db.changeUserPassword("app_user", "NewPassword123!")

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ€Ğ¾Ğ»ÑŒ
db.grantRolesToUser("app_user", [{ role: "dbAdmin", db: "myapp" }])

// Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ€Ğ¾Ğ»ÑŒ
db.revokeRolesFromUser("app_user", [{ role: "dbAdmin", db: "myapp" }])
```

**ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ñ€Ğ¾Ğ»Ğ¸:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½ÑƒÑ Ñ€Ğ¾Ğ»ÑŒ
use admin
db.createRole({
  role: "readOnlyLogs",
  privileges: [
    {
      resource: { db: "logs", collection: "" },
      actions: ["find", "listCollections"]
    }
  ],
  roles: []
})

// Ğ Ğ¾Ğ»ÑŒ Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ¾Ğ¼
db.createRole({
  role: "reportUser",
  privileges: [
    {
      resource: { db: "analytics", collection: "reports" },
      actions: ["find", "aggregate"]
    }
  ],
  roles: []
})

// ĞĞ°Ğ·Ğ½Ğ°Ñ‡ÑŒ Ñ€Ğ¾Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
db.grantRolesToUser("analyst", ["reportUser"])
```

**Ğ’ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:**
```yaml
# Ğ’ mongod.conf
security:
  authorization: enabled
  
# Ğ˜Ğ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ
mongod --auth --dbpath /data/db
```

**TLS/SSL ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**
```yaml
# mongod.conf
net:
  ssl:
    mode: requireSSL
    PEMKeyFile: /path/to/mongodb.pem
    CAFile: /path/to/ca.pem
    allowConnectionsWithoutCertificates: false
```

```bash
# ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ñ TLS
mongosh "mongodb://host:27017" \
  --tls \
  --tlsCAFile /path/to/ca.pem \
  --tlsCertificateKeyFile /path/to/client.pem
```

**Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Encryption at Rest):**
```yaml
# mongod.conf (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Enterprise)
security:
  enableEncryption: true
  encryptionKeyFile: /path/to/keyfile

# Ğ˜Ğ»Ğ¸ Ñ KMIP
security:
  enableEncryption: true
  kmip:
    serverName: kmip.example.com
    port: 5696
    clientCertificateFile: /path/to/client.pem
```

**ĞÑƒĞ´Ğ¸Ñ‚ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Enterprise):**
```yaml
# mongod.conf
auditLog:
  destination: file
  format: JSON
  path: /var/log/mongodb/audit.json
  filter: '{ atype: { $in: ["authenticate", "createUser", "dropDatabase"] } }'
```

**IP Whitelisting:**
```yaml
# mongod.conf
net:
  bindIp: 127.0.0.1,192.168.1.0/24
  
# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· firewall
# iptables -A INPUT -p tcp --dport 27017 -s 192.168.1.0/24 -j ACCEPT
# iptables -A INPUT -p tcp --dport 27017 -j DROP
```

**Field-Level Encryption (Client-Side):**
```javascript
// ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ĞµĞ¹
const clientEncryption = new ClientEncryption(keyVaultClient, {
  keyVaultNamespace: 'encryption.__keyVault',
  kmsProviders: {
    local: {
      key: localMasterKey
    }
  }
})

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ data key
const dataKeyId = await clientEncryption.createDataKey('local')

// Ğ¨Ğ¸Ñ„Ñ€ÑƒĞ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
const encryptedValue = await clientEncryption.encrypt(
  'sensitive data',
  {
    keyId: dataKeyId,
    algorithm: 'AEAD_AES_256_CBC_HMAC_SHA_512-Deterministic'
  }
)

db.users.insertOne({
  name: 'John',
  ssn: encryptedValue
})
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ MongoDB:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ Ñ€Ğ¾Ğ»ÑĞ¼Ğ¸:
   ```javascript
   // ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ğ±ĞµĞ· Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
   mongosh
   
   use admin
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ root Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
   db.createUser({
     user: "dbadmin",
     pwd: "SuperSecure123!",
     roles: [
       { role: "root", db: "admin" }
     ]
   })
   
   // ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ MongoDB Ñ --auth
   // docker restart mongodb (Ğ¸Ğ»Ğ¸ systemctl restart mongod)
   
   // ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
   mongosh -u dbadmin -p "SuperSecure123!" --authenticationDatabase admin
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
   use myapp
   db.createUser({
     user: "app_user",
     pwd: "AppPassword123!",
     roles: [
       { role: "readWrite", db: "myapp" }
     ]
   })
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ
   db.createUser({
     user: "readonly_user",
     pwd: "ReadPassword123!",
     roles: [
       { role: "read", db: "myapp" }
     ]
   })
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°
   db.createUser({
     user: "analyst",
     pwd: "AnalystPassword123!",
     roles: [
       { role: "read", db: "myapp" },
       { role: "read", db: "analytics" }
     ]
   })
   ```

2. ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹ Ñ€Ğ°Ğ·Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°:
   ```bash
   # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ ĞºĞ°Ğº app_user
   mongosh -u app_user -p "AppPassword123!" myapp
   ```
   
   ```javascript
   // Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
   db.test.insertOne({ message: "Hello" })
   db.test.find()
   
   // ĞĞµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ (Ğ½ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ² Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ‘Ğ”)
   use admin
   show collections  // ĞÑˆĞ¸Ğ±ĞºĞ°
   
   exit
   ```
   
   ```bash
   # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸ÑÑŒ ĞºĞ°Ğº readonly_user
   mongosh -u readonly_user -p "ReadPassword123!" myapp
   ```
   
   ```javascript
   // Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
   db.test.find()
   
   // ĞĞµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
   db.test.insertOne({ message: "Try to write" })  // ĞÑˆĞ¸Ğ±ĞºĞ°
   ```

3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½ÑƒÑ Ñ€Ğ¾Ğ»ÑŒ:
   ```bash
   mongosh -u dbadmin -p "SuperSecure123!" --authenticationDatabase admin
   ```
   
   ```javascript
   use admin
   
   // Ğ Ğ¾Ğ»ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ»Ğ¾Ğ³Ğ¾Ğ²
   db.createRole({
     role: "logViewer",
     privileges: [
       {
         resource: { db: "myapp", collection: "logs" },
         actions: ["find", "listIndexes"]
       }
     ],
     roles: []
   })
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ñ ÑÑ‚Ğ¾Ğ¹ Ñ€Ğ¾Ğ»ÑŒÑ
   use myapp
   db.createUser({
     user: "log_viewer",
     pwd: "LogPassword123!",
     roles: ["logViewer"]
   })
   
   // Ğ¢ĞµÑÑ‚
   exit
   ```
   
   ```bash
   mongosh -u log_viewer -p "LogPassword123!" myapp
   ```
   
   ```javascript
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ logs
   use myapp
   db.createCollection("logs")
   
   // Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
   db.logs.find()
   
   // ĞĞµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
   db.test.find()  // ĞÑˆĞ¸Ğ±ĞºĞ°
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Connection String Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸:**
```bash
# Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹
mongodb://user:pass@host:27017/dbname

# Ğ¡ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ¾Ğ¹
mongodb://user:pass@host1:27017,host2:27017,host3:27017/dbname?replicaSet=rs0

# Ğ¡ TLS
mongodb://user:pass@host:27017/dbname?tls=true&tlsCAFile=/path/to/ca.pem

# Ğ¡ Ğ¾Ğ¿Ñ†Ğ¸ÑĞ¼Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
mongodb://user:pass@host:27017/dbname?authSource=admin&authMechanism=SCRAM-SHA-256

# MongoDB Atlas
mongodb+srv://user:pass@cluster.mongodb.net/dbname?retryWrites=true&w=majority
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ MongoDB Secrets Ğ² Kubernetes:**
```yaml
# mongodb-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: mongodb-secret
type: Opaque
stringData:
  mongodb-root-password: SuperSecure123!
  mongodb-user: app_user
  mongodb-password: AppPassword123!
  mongodb-database: myapp

---
# mongodb-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mongodb
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mongodb
  template:
    metadata:
      labels:
        app: mongodb
    spec:
      containers:
      - name: mongodb
        image: mongo:7.0
        env:
        - name: MONGO_INITDB_ROOT_USERNAME
          value: admin
        - name: MONGO_INITDB_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mongodb-secret
              key: mongodb-root-password
        - name: MONGO_INITDB_DATABASE
          valueFrom:
            secretKeyRef:
              name: mongodb-secret
              key: mongodb-database
        ports:
        - containerPort: 27017
        volumeMounts:
        - name: mongodb-data
          mountPath: /data/db
      volumes:
      - name: mongodb-data
        persistentVolumeClaim:
          claimName: mongodb-pvc
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 8: Backup Ğ¸ Recovery (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ±ÑĞºĞ°Ğ¿Ğ° MongoDB:**

1. **mongodump/mongorestore** - Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±ÑĞºĞ°Ğ¿:
```bash
# ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿ Ğ²ÑĞµÑ… Ğ‘Ğ”
mongodump --uri="mongodb://admin:pass@localhost:27017" --out=/backup/$(date +%Y%m%d)

# Ğ‘ÑĞºĞ°Ğ¿ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ‘Ğ”
mongodump --uri="mongodb://admin:pass@localhost:27017" --db=myapp --out=/backup/myapp

# Ğ‘ÑĞºĞ°Ğ¿ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
mongodump --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users --out=/backup/users

# Ğ¡ gzip ÑĞ¶Ğ°Ñ‚Ğ¸ĞµĞ¼
mongodump --uri="mongodb://admin:pass@localhost:27017" --gzip --out=/backup/compressed

# Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑ…ĞµĞ¼Ğ° (Ğ±ĞµĞ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
mongodump --uri="mongodb://admin:pass@localhost:27017" --db=myapp --excludeCollection=logs

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
mongorestore --uri="mongodb://admin:pass@localhost:27017" /backup/20241221

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ‘Ğ”
mongorestore --uri="mongodb://admin:pass@localhost:27017" --db=myapp /backup/myapp

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ Ğ·Ğ°Ğ¼ĞµĞ½Ğ¾Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
mongorestore --uri="mongodb://admin:pass@localhost:27017" --drop /backup/20241221

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ´Ñ€ÑƒĞ³ÑƒÑ Ğ‘Ğ”
mongorestore --uri="mongodb://admin:pass@localhost:27017" \
  --nsFrom="myapp.*" --nsTo="myapp_test.*" /backup/myapp
```

2. **Ğ¡Ğ½Ğ°Ğ¿ÑˆĞ¾Ñ‚Ñ‹ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹** (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸):
```bash
# Ğ—Ğ°Ğ¼Ğ¾Ñ€Ğ¾Ğ·ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
mongosh --eval "db.fsyncLock()"

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑĞ½Ğ°Ğ¿ÑˆĞ¾Ñ‚ (Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ¤Ğ¡/Ğ¾Ğ±Ğ»Ğ°ĞºĞ°)
# LVM snapshot
lvcreate -L 10G -s -n mongodb_snap /dev/vg/mongodb

# AWS EBS snapshot
aws ec2 create-snapshot --volume-id vol-xxxxx

# Ğ Ğ°Ğ·Ğ¼Ğ¾Ñ€Ğ¾Ğ·ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
mongosh --eval "db.fsyncUnlock()"
```

3. **Continuous Backup (Replica Set Oplog):**
```bash
# Ğ‘ÑĞºĞ°Ğ¿ oplog Ğ´Ğ»Ñ Point-in-Time Recovery
mongodump --uri="mongodb://admin:pass@localhost:27017" \
  --oplog --out=/backup/oplog_$(date +%Y%m%d_%H%M%S)

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚
mongorestore --uri="mongodb://admin:pass@localhost:27017" \
  --oplogReplay --oplogLimit=1640995200:1 /backup/oplog
```

4. **MongoDB Cloud Manager / Ops Manager** (Enterprise):
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ½Ğ°Ğ¿ÑˆĞ¾Ñ‚Ñ‹
- Point-in-Time Recovery
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹

**Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ±ÑĞºĞ°Ğ¿Ğ°:**
```bash
#!/bin/bash
# backup-mongodb.sh - Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ³Ğ¾ Ğ±ÑĞºĞ°Ğ¿Ğ°

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/mongodb"
MONGO_URI="mongodb://backup_user:password@localhost:27017"
RETENTION_DAYS=7

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ
mkdir -p "$BACKUP_DIR"

# Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ±ÑĞºĞ°Ğ¿
mongodump --uri="$MONGO_URI" --gzip --out="$BACKUP_DIR/$DATE"

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ÑÑ‚ÑŒ
if [ $? -eq 0 ]; then
  echo "Backup completed successfully: $BACKUP_DIR/$DATE"
  
  # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸ Ğ² S3 (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
  aws s3 sync "$BACKUP_DIR/$DATE" "s3://my-mongodb-backups/$DATE/"
  
  # Ğ£Ğ´Ğ°Ğ»Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ±ÑĞºĞ°Ğ¿Ñ‹
  find "$BACKUP_DIR" -type d -mtime +$RETENTION_DAYS -exec rm -rf {} \;
else
  echo "Backup failed!"
  exit 1
fi
```

**Cron Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ±ÑĞºĞ°Ğ¿Ğ°:**
```bash
# Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ Ğ² crontab
# crontab -e

# Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾ Ğ² 2:00
0 2 * * * /scripts/backup-mongodb.sh >> /var/log/mongodb-backup.log 2>&1

# Ğ•Ğ¶ĞµĞ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¾ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿ Ğ² Ğ²Ğ¾ÑĞºÑ€ĞµÑĞµĞ½ÑŒĞµ
0 3 * * 0 /scripts/full-backup-mongodb.sh >> /var/log/mongodb-backup.log 2>&1
```

**Export/Import Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:**
```bash
# mongoexport - ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² JSON/CSV
mongoexport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users --out=users.json

# Ğ¡ query Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ¼
mongoexport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users \
  --query='{"age":{"$gte":18}}' --out=adult_users.json

# Ğ’ CSV Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ
mongoexport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users \
  --type=csv --fields=name,email,age --out=users.csv

# mongoimport - Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
mongoimport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users --file=users.json

# CSV Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚
mongoimport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users \
  --type=csv --headerline --file=users.csv

# Ğ ĞµĞ¶Ğ¸Ğ¼ upsert (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ°)
mongoimport --uri="mongodb://admin:pass@localhost:27017" \
  --db=myapp --collection=users \
  --mode=upsert --upsertFields=email --file=users.json
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ±ÑĞºĞ°Ğ¿Ğ¾Ğ²:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
   ```javascript
   mongosh
   
   use backup_test
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ±ÑĞºĞ°Ğ¿Ğ°
   for(let i = 0; i < 1000; i++) {
     db.users.insertOne({
       user_id: i,
       name: "User " + i,
       email: `user${i}@example.com`,
       created_at: new Date()
     })
   }
   
   db.orders.insertMany([
     { order_id: 1, user_id: 1, total: 100, date: new Date() },
     { order_id: 2, user_id: 2, total: 250, date: new Date() }
   ])
   ```

2. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ±ÑĞºĞ°Ğ¿:
   ```bash
   # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑĞºĞ°Ğ¿Ğ¾Ğ²
   mkdir -p ~/mongodb_backups
   
   # ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
   mongodump --db=backup_test --out=~/mongodb_backups/full_$(date +%Y%m%d)
   
   # Ğ¡Ğ¶Ğ°Ñ‚Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
   mongodump --db=backup_test --gzip --out=~/mongodb_backups/compressed_$(date +%Y%m%d)
   
   # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€
   du -sh ~/mongodb_backups/*
   
   # Ğ‘ÑĞºĞ°Ğ¿ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸ users
   mongodump --db=backup_test --collection=users --out=~/mongodb_backups/users_only
   ```

3. ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:
   ```bash
   # Ğ£Ğ´Ğ°Ğ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   mongosh
   ```
   
   ```javascript
   use backup_test
   db.dropDatabase()
   show dbs  // backup_test Ğ¸ÑÑ‡ĞµĞ·Ğ»Ğ°
   exit
   ```
   
   ```bash
   # Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ Ğ¸Ğ· Ğ±ÑĞºĞ°Ğ¿Ğ°
   mongorestore --db=backup_test ~/mongodb_backups/full_20241221/backup_test
   
   # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ
   mongosh
   ```
   
   ```javascript
   use backup_test
   db.users.countDocuments()  // Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ 1000
   db.orders.countDocuments()  // Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ 2
   ```

4. Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚/Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:
   ```bash
   # Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² JSON
   mongoexport --db=backup_test --collection=users \
     --query='{"user_id":{"$lt":10}}' \
     --out=~/mongodb_backups/first_10_users.json
   
   # Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² CSV
   mongoexport --db=backup_test --collection=users \
     --type=csv --fields=user_id,name,email \
     --out=~/mongodb_backups/users.csv
   
   # ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
   head -20 ~/mongodb_backups/users.csv
   
   # Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾
   mongoimport --db=test_import --collection=users \
     --file=~/mongodb_backups/first_10_users.json
   ```

5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ±ÑĞºĞ°Ğ¿Ğ°:
   ```bash
   cat > ~/backup-mongodb.sh <<'EOF'
#!/bin/bash

BACKUP_DIR="$HOME/mongodb_backups"
DATE=$(date +%Y%m%d_%H%M%S)
MONGO_URI="mongodb://localhost:27017"
RETENTION_DAYS=7

echo "Starting backup at $(date)"

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ±ÑĞºĞ°Ğ¿
mongodump --uri="$MONGO_URI" --gzip --out="$BACKUP_DIR/$DATE"

if [ $? -eq 0 ]; then
  echo "Backup completed: $BACKUP_DIR/$DATE"
  
  # Ğ£Ğ´Ğ°Ğ»Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ±ÑĞºĞ°Ğ¿Ñ‹
  find "$BACKUP_DIR" -type d -mtime +$RETENTION_DAYS -exec rm -rf {} \; 2>/dev/null
  
  echo "Old backups cleaned up (retention: $RETENTION_DAYS days)"
else
  echo "Backup failed!"
  exit 1
fi
EOF

   chmod +x ~/backup-mongodb.sh
   
   # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚
   ~/backup-mongodb.sh
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ±ÑĞºĞ°Ğ¿ Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¾Ğ¹ Ğ² S3:**
```bash
#!/bin/bash
# backup-to-s3.sh

BACKUP_DIR="/tmp/mongodb_backup"
DATE=$(date +%Y%m%d_%H%M%S)
S3_BUCKET="s3://my-mongodb-backups"
MONGO_URI="mongodb://backup_user:password@localhost:27017"

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ±ÑĞºĞ°Ğ¿
mongodump --uri="$MONGO_URI" --gzip --out="$BACKUP_DIR/$DATE"

# Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸ Ğ² S3
aws s3 sync "$BACKUP_DIR/$DATE" "$S3_BUCKET/$DATE/"

# Ğ£Ğ´Ğ°Ğ»Ğ¸ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
rm -rf "$BACKUP_DIR/$DATE"

# ĞÑÑ‚Ğ°Ğ²ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 30 Ğ´Ğ½ĞµĞ¹ Ğ² S3
aws s3 ls "$S3_BUCKET/" | while read -r line; do
  backup_date=$(echo $line | awk '{print $2}' | sed 's/\///')
  backup_epoch=$(date -d "${backup_date:0:8}" +%s)
  current_epoch=$(date +%s)
  days_old=$(( ($current_epoch - $backup_epoch) / 86400 ))
  
  if [ $days_old -gt 30 ]; then
    aws s3 rm "$S3_BUCKET/$backup_date" --recursive
    echo "Deleted old backup: $backup_date"
  fi
done
```

**Point-in-Time Recovery Ñ Oplog:**
```bash
# 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿ Ñ oplog
mongodump --uri="mongodb://localhost:27017" \
  --oplog --out=/backup/base

# 2. ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ±ÑĞºĞ°Ğ¿Ğ¸Ñ€ÑƒĞ¹ oplog
mongodump --uri="mongodb://localhost:27017" \
  -d local -c oplog.rs --out=/backup/oplog_incremental_$(date +%Y%m%d_%H%M%S)

# 3. Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
# ĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ğ¼, Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ° 2024-12-21 15:30:00

# Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
mongorestore --drop /backup/base

# Ğ—Ğ°Ñ‚ĞµĞ¼ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµĞ¼ oplog Ğ´Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ°
# timestamp Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ ÑĞµĞºÑƒĞ½Ğ´Ñ‹:Ğ¸Ğ½ĞºÑ€ĞµĞ¼ĞµĞ½Ñ‚
TIMESTAMP=$(date -d "2024-12-21 15:30:00" +%s):1

mongorestore --oplogReplay \
  --oplogLimit=$TIMESTAMP \
  /backup/base/oplog.bson
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 9: ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ troubleshooting (30 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°:**
```javascript
// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ°
db.serverStatus()

// ĞšÑ€Ğ°Ñ‚ĞºĞ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
db.serverStatus().connections
db.serverStatus().opcounters
db.serverStatus().network

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ‘Ğ”
db.stats()

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
db.users.stats()

// Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
db.currentOp()

// ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
db.currentOp({ "secs_running": { "$gt": 5 } })

// Ğ£Ğ±Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ
db.killOp(12345)

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
db.users.aggregate([{ $indexStats: {} }])

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
db.serverStatus().mem

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¸ÑĞºĞ°
db.stats().dataSize
db.stats().storageSize
```

**ĞŸÑ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€ (Ğ²ÑĞµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)
db.setProfilingLevel(2)

// ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ (>100ms)
db.setProfilingLevel(1, { slowms: 100 })

// Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ
db.setProfilingLevel(0)

// ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
db.system.profile.find().sort({ ts: -1 }).limit(10).pretty()

// Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ 500ms
db.system.profile.find({ millis: { $gt: 500 } }).sort({ millis: -1 })

// Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
db.system.profile.aggregate([
  {
    $group: {
      _id: "$op",
      count: { $sum: 1 },
      avgDuration: { $avg: "$millis" }
    }
  },
  { $sort: { avgDuration: -1 } }
])

// ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€
db.system.profile.drop()
```

**Ğ›Ğ¾Ğ³Ğ¸ MongoDB:**
```bash
# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ²
tail -f /var/log/mongodb/mongod.log

# Ğ¡ Docker
docker logs -f mongodb

# Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
grep "slow query" /var/log/mongodb/mongod.log

# ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
grep "error" /var/log/mongodb/mongod.log | tail -20

# Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
db.setLogLevel(1)  # 0-5, Ğ³Ğ´Ğµ 5 ÑĞ°Ğ¼Ñ‹Ğ¹ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹

# Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°
db.setLogLevel(2, "query")
db.setLogLevel(3, "replication")
```

**ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°:**
```javascript
// Connections
db.serverStatus().connections.current
db.serverStatus().connections.available

// Operations per second
db.serverStatus().opcounters

// Replication lag (Ğ´Ğ»Ñ replica set)
rs.printSecondaryReplicationInfo()

// Memory usage
db.serverStatus().mem.resident
db.serverStatus().mem.virtual

// Lock statistics
db.serverStatus().locks

// Page faults
db.serverStatus().extra_info.page_faults

// WiredTiger cache
db.serverStatus().wiredTiger.cache["bytes currently in the cache"]
db.serverStatus().wiredTiger.cache["maximum bytes configured"]
```

**MongoDB Monitoring Tools:**

1. **MongoDB Compass** - GUI Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ¾Ğ¼
2. **MongoDB Atlas** - Ğ¾Ğ±Ğ»Ğ°Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
3. **mongostat** - ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°:
```bash
# Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
mongostat --uri="mongodb://localhost:27017" 5  # ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 5 ÑĞµĞºÑƒĞ½Ğ´

# Ğ¡ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
mongostat --uri="mongodb://admin:pass@localhost:27017" --authenticationDatabase admin
```

4. **mongotop** - Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸ÑĞ¼:
```bash
# Ğ¢Ğ¾Ğ¿ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹
mongotop --uri="mongodb://localhost:27017" 5

# Ğ¡ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹
mongotop --uri="mongodb://localhost:27017" --locks
```

5. **Prometheus + Grafana**:
```yaml
# mongodb-exporter Ğ´Ğ»Ñ Prometheus
docker run -d \
  -p 9216:9216 \
  percona/mongodb_exporter:0.40 \
  --mongodb.uri=mongodb://exporter:password@mongodb:27017
```

**Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ğ¸ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:**

1. **ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:**
```javascript
// ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
db.system.profile.find({ millis: { $gt: 1000 } }).sort({ millis: -1 }).limit(5)

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
db.users.find({ email: "test@example.com" }).explain("executionStats")

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑ
db.users.createIndex({ email: 1 })
```

2. **Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:**
```javascript
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ ĞºÑÑˆĞ°
db.serverStatus().wiredTiger.cache

// ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ ĞºÑÑˆ Ğ² ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğµ
// storage.wiredTiger.engineConfig.cacheSizeGB: 2
```

3. **ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹:**
```javascript
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
rs.status()

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºÑƒ
rs.printSecondaryReplicationInfo()

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ oplog
db.getReplicationInfo()
```

4. **Ğ˜ÑÑ‡ĞµÑ€Ğ¿Ğ°Ğ½Ğ¸Ğµ connections:**
```javascript
// Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
db.serverStatus().connections

// Ğ£Ğ±Ğ¸Ñ‚ÑŒ idle Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
db.currentOp({ "active": false, "secs_running": { "$gt": 300 } }).inprog.forEach(function(op) {
  if(op.op == "query" || op.op == "getmore") {
    db.killOp(op.opid);
  }
})
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ½Ğ°Ğ¹Ğ´Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½ÑƒÑ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ:
   ```javascript
   mongosh
   
   use performance_test
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ±Ğ¾Ğ»ÑŒÑˆÑƒÑ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ğ±ĞµĞ· Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
   for(let i = 0; i < 50000; i++) {
     db.slow_collection.insertOne({
       user_id: i,
       email: `user${i}@example.com`,
       data: "x".repeat(1000),  // 1KB Ñ‚ĞµĞºÑÑ‚Ğ°
       created_at: new Date()
     })
   }
   ```

2. Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€:
   ```javascript
   // ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ 50ms
   db.setProfilingLevel(1, { slowms: 50 })
   
   // Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
   db.slow_collection.find({ email: "user25000@example.com" })
   db.slow_collection.find({ user_id: { $gt: 40000 } })
   db.slow_collection.find({ created_at: { $gte: new Date("2024-01-01") } })
   
   // ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»
   db.system.profile.find().sort({ ts: -1 }).limit(5).pretty()
   
   // ĞĞ°Ğ¹Ğ´Ğ¸ ÑĞ°Ğ¼Ñ‹Ğµ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ
   db.system.profile.find().sort({ millis: -1 }).limit(5)
   ```

3. ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:
   ```javascript
   // Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·
   db.slow_collection.find({ email: "user25000@example.com" }).explain("executionStats")
   
   // ĞĞ±Ñ€Ğ°Ñ‚Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ°:
   // - executionTimeMillis
   // - totalDocsExamined (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ±Ğ»Ğ¸Ğ·ĞºĞ¾ Ğº nReturned)
   // - stage: "COLLSCAN" (Ğ¿Ğ»Ğ¾Ñ…Ğ¾) vs "IXSCAN" (Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾)
   
   // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ
   db.slow_collection.createIndex({ email: 1 })
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ ÑĞ½Ğ¾Ğ²Ğ°
   db.slow_collection.find({ email: "user25000@example.com" }).explain("executionStats")
   
   // Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸ Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
   ```

4. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ mongostat:
   ```bash
   # Ğ’ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ
   mongostat --uri="mongodb://localhost:27017" 2
   
   # ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ğ¹ Ğ·Ğ°:
   # - insert/query/update/delete - Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ
   # - dirty/used - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ WiredTiger cache
   # - res - resident memory
   # - qr|qw - Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ Ğ½Ğ° Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ/Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ
   ```

5. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ mongotop:
   ```bash
   # Ğ¢Ğ¾Ğ¿ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¹
   mongotop --uri="mongodb://localhost:27017" 5
   
   # Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
   ```

6. Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹:
   ```javascript
   // Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
   db.currentOp()
   
   // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ
   db.currentOp({ "active": true })
   
   // ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
   db.currentOp({ "secs_running": { "$gt": 3 } })
   
   // ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ½Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
   db.currentOp({ "ns": "performance_test.slow_collection" })
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ Prometheus + Grafana Ğ´Ğ»Ñ MongoDB:**
```yaml
# docker-compose-monitoring.yml
version: '3.8'

services:
  mongodb-exporter:
    image: percona/mongodb_exporter:0.40
    container_name: mongodb-exporter
    command:
      - '--mongodb.uri=mongodb://admin:password123@mongodb:27017'
      - '--collect-all'
    ports:
      - "9216:9216"
    depends_on:
      - mongodb

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana_data:/var/lib/grafana
    depends_on:
      - prometheus

volumes:
  prometheus_data:
  grafana_data:
```

```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'mongodb'
    static_configs:
      - targets: ['mongodb-exporter:9216']
```

**Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº:**
```yaml
# alerts.yml
groups:
  - name: mongodb_alerts
    interval: 30s
    rules:
      - alert: MongoDBDown
        expr: mongodb_up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "MongoDB instance is down"
          
      - alert: MongoDBHighConnections
        expr: mongodb_connections{state="current"} > 1000
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "MongoDB has too many connections"
          
      - alert: MongoDBReplicationLag
        expr: mongodb_mongod_replset_member_replication_lag > 10
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "MongoDB replication lag is high"
```

---

## ĞœĞ¾Ğ´ÑƒĞ»ÑŒ 10: Best Practices Ğ¸ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### ğŸ¯ ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ»ĞºĞ°

**Ğ”Ğ¸Ğ·Ğ°Ğ¹Ğ½ ÑÑ…ĞµĞ¼Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:**

**1. Embedded Documents (Ğ’ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ):**
```javascript
// Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ğ´Ğ»Ñ One-to-Few Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğ¹
{
  _id: 1,
  name: "John Doe",
  addresses: [
    { street: "123 Main St", city: "New York" },
    { street: "456 Oak Ave", city: "Boston" }
  ]
}

// ĞŸĞ»ÑÑÑ‹: Ğ¾Ğ´Ğ½Ğ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ, Ğ°Ñ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ğ¾ÑÑ‚ÑŒ
// ĞœĞ¸Ğ½ÑƒÑÑ‹: Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ñ€Ğ°ÑÑ‚Ğ¸, 16MB Ğ»Ğ¸Ğ¼Ğ¸Ñ‚
```

**2. References (Ğ¡ÑÑ‹Ğ»ĞºĞ¸):**
```javascript
// Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ğ´Ğ»Ñ One-to-Many Ğ¸ Many-to-Many
// Users ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ
{
  _id: 1,
  name: "John Doe"
}

// Orders ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ
{
  _id: 101,
  user_id: 1,  // Ğ¡ÑÑ‹Ğ»ĞºĞ°
  total: 150
}

// ĞŸĞ»ÑÑÑ‹: Ğ½ĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ, Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ° ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ
// ĞœĞ¸Ğ½ÑƒÑÑ‹: Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ JOIN ($lookup)
```

**3. Extended Reference (Ğ”ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ):**
```javascript
// Ğ—Ğ¾Ğ»Ğ¾Ñ‚Ğ°Ñ ÑĞµÑ€ĞµĞ´Ğ¸Ğ½Ğ° - Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ¼ Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ
{
  _id: 101,
  user_id: 1,
  user_name: "John Doe",  // Ğ”ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
  user_email: "john@example.com",
  total: 150
}

// ĞŸĞ»ÑÑÑ‹: Ğ¼ĞµĞ½ÑŒÑˆĞµ JOIN'Ğ¾Ğ²
// ĞœĞ¸Ğ½ÑƒÑÑ‹: Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑ‚ÑŒ Ğ² Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ¼ĞµÑÑ‚Ğ°Ñ…
```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ğ° ÑÑ…ĞµĞ¼Ñ‹:**
```
1. Embed ĞºĞ¾Ğ³Ğ´Ğ°:
   - ĞÑ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ¸Ğ½-Ğº-Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ğ¼ (One-to-Few)
   - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ²ÑĞµĞ³Ğ´Ğ° Ñ‡Ğ¸Ñ‚Ğ°ÑÑ‚ÑÑ Ğ²Ğ¼ĞµÑÑ‚Ğµ
   - Ğ’Ğ»Ğ¾Ğ¶ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ Ñ‡Ğ°ÑÑ‚Ğ¾
   
2. Reference ĞºĞ¾Ğ³Ğ´Ğ°:
   - ĞÑ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ¸Ğ½-ĞºĞ¾-Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğ¼ (One-to-Many)
   - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ñ€Ğ°ÑÑ‚Ğ¸ Ğ½ĞµĞ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ¾
   - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾
   
3. Ğ”ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞ¹ ĞºĞ¾Ğ³Ğ´Ğ°:
   - ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ°
   - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ Ñ€ĞµĞ´ĞºĞ¾
   - Ğ”Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ğ° eventual consistency
```

**ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²:**
```javascript
// ESR Rule: Equality, Sort, Range
// 1. Equality (=) Ğ¿Ğ¾Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼Ğ¸
// 2. Sort Ğ¿Ğ¾Ğ»Ñ Ğ²Ñ‚Ğ¾Ñ€Ñ‹Ğ¼Ğ¸
// 3. Range (<, >, !=) Ğ¿Ğ¾Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¼Ğ¸

// ĞŸĞ»Ğ¾Ñ…Ğ¾
db.orders.createIndex({ total: 1, customer_id: 1, date: 1 })

// Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ (ĞµÑĞ»Ğ¸ query: customer_id=X, sort by date, total > Y)
db.orders.createIndex({ customer_id: 1, date: 1, total: 1 })

// ĞŸĞ¾ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ (Covered Queries)
db.users.createIndex({ email: 1, name: 1, age: 1 })

db.users.find(
  { email: "john@example.com" },
  { email: 1, name: 1, age: 1, _id: 0 }
)
// Ğ’ÑĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· Ğ¸Ğ½Ğ´ĞµĞºÑĞ°, Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚!

// Ğ˜Ğ·Ğ±ĞµĞ³Ğ°Ğ¹
// - Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ² (Ğ·Ğ°Ğ¼ĞµĞ´Ğ»ÑÑÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ)
// - ĞĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
// - Ğ”ÑƒĞ±Ğ»Ğ¸Ñ€ÑƒÑÑ‰Ğ¸ĞµÑÑ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
```

**ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**
```javascript
// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ° Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ĞµĞ¹
db.users.find({ age: 25 })

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ½ÑƒĞ¶Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹
db.users.find({ age: 25 }, { name: 1, email: 1 })

// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - skip Ğ½Ğ° Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ‡Ğ¸ÑĞ»Ğ°Ñ…
db.users.find().skip(100000).limit(10)

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - range query Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¼ ID
db.users.find({ _id: { $gt: lastSeenId } }).limit(10)

// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - $where Ğ¸ JavaScript
db.users.find({ $where: "this.age > 25" })

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹
db.users.find({ age: { $gt: 25 } })

// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ñ€ĞµĞ³ÑƒĞ»ÑÑ€ĞºĞ¸ Ğ±ĞµĞ· ÑĞºĞ¾Ñ€Ñ
db.users.find({ name: /john/i })

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ñ ÑĞºĞ¾Ñ€ĞµĞ¼ Ğ² Ğ½Ğ°Ñ‡Ğ°Ğ»Ğµ
db.users.find({ name: /^john/i })
db.users.createIndex({ name: 1 })  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑ!

// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - $ne Ğ¸ $nin Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾
db.users.find({ status: { $ne: "deleted" } })

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
db.users.find({ status: { $in: ["active", "pending"] } })
```

**Connection Pooling:**
```javascript
// Node.js Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ¿ÑƒĞ»Ğ¾Ğ¼ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
const { MongoClient } = require('mongodb');

const client = new MongoClient(uri, {
  maxPoolSize: 50,        // ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
  minPoolSize: 10,        // ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
  maxIdleTimeMS: 30000,   // Timeout Ğ´Ğ»Ñ idle Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
  serverSelectionTimeoutMS: 5000,
  socketTimeoutMS: 45000
});

// ĞŸĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ!
let cachedClient = null;

async function connectToDatabase() {
  if (cachedClient) {
    return cachedClient;
  }
  
  cachedClient = await client.connect();
  return cachedClient;
}
```

**ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°:**
```javascript
// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
for (let i = 0; i < 1000; i++) {
  await db.users.insertOne({ name: `User ${i}` });
}

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - batch Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
const batch = [];
for (let i = 0; i < 1000; i++) {
  batch.push({ name: `User ${i}` });
  
  if (batch.length >= 100) {
    await db.users.insertMany(batch);
    batch.length = 0;
  }
}
if (batch.length > 0) {
  await db.users.insertMany(batch);
}

// Bulk Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
const bulk = db.users.initializeUnorderedBulkOp();

for (let i = 0; i < 1000; i++) {
  bulk.insert({ name: `User ${i}` });
}

await bulk.execute();
```

**Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼Ğ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸:**
```javascript
// GridFS Ğ´Ğ»Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² >16MB
const { GridFSBucket } = require('mongodb');

const bucket = new GridFSBucket(db, {
  bucketName: 'uploads'
});

// Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ñ„Ğ°Ğ¹Ğ»Ğ°
const uploadStream = bucket.openUploadStream('myfile.pdf');
fs.createReadStream('./myfile.pdf').pipe(uploadStream);

// Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
const downloadStream = bucket.openDownloadStreamByName('myfile.pdf');
downloadStream.pipe(fs.createWriteStream('./downloaded.pdf'));

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
const files = await bucket.find({ filename: 'myfile.pdf' }).toArray();
await bucket.delete(files[0]._id);
```

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸:**
```yaml
# mongod.conf
storage:
  wiredTiger:
    engineConfig:
      cacheSizeGB: 2  # 50% RAM Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ
      journalCompressor: snappy
    collectionConfig:
      blockCompressor: snappy

operationProfiling:
  mode: slowOp
  slowOpThresholdMs: 100

setParameter:
  cursorTimeoutMillis: 600000
  notablescan: 0  # Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ Ğ² 1 Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ COLLSCAN Ğ² production
```

### ğŸ’» Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ

ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ:

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ½ĞµĞ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½ÑƒÑ ÑÑ…ĞµĞ¼Ñƒ:
   ```javascript
   mongosh
   
   use optimization_test
   
   // ĞŸĞ»Ğ¾Ñ…Ğ°Ñ ÑÑ…ĞµĞ¼Ğ° - Ğ²ÑĞµ Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸
   for(let i = 0; i < 10000; i++) {
     db.bad_design.insertOne({
       order_id: i,
       customer_name: `Customer ${i % 100}`,
       customer_email: `customer${i % 100}@example.com`,
       customer_address: `${i} Main St`,
       product_name: `Product ${i % 50}`,
       product_price: Math.floor(Math.random() * 1000),
       product_category: ["Electronics", "Furniture", "Clothing"][i % 3],
       order_date: new Date(),
       quantity: Math.floor(Math.random() * 10) + 1
     })
   }
   ```

2. ĞĞ°Ğ¹Ğ´Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹:
   ```javascript
   // Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€
   db.setProfilingLevel(2)
   
   // Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
   db.bad_design.find({ 
     customer_email: "customer50@example.com" 
   })
   
   // ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹
   db.bad_design.find({ 
     customer_email: "customer50@example.com" 
   }).explain("executionStats")
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ°Ğ¹Ğ»
   db.system.profile.find().sort({ millis: -1 }).limit(5)
   ```

3. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ ÑÑ…ĞµĞ¼Ñƒ:
   ```javascript
   // ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
   
   // Customers
   db.customers.insertMany([...Array(100)].map((_, i) => ({
     _id: i,
     name: `Customer ${i}`,
     email: `customer${i}@example.com`,
     address: `${i} Main St`
   })))
   
   // Products
   db.products.insertMany([...Array(50)].map((_, i) => ({
     _id: i,
     name: `Product ${i}`,
     price: Math.floor(Math.random() * 1000),
     category: ["Electronics", "Furniture", "Clothing"][i % 3]
   })))
   
   // Orders (Ñ Ğ´ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹)
   for(let i = 0; i < 10000; i++) {
     const customerId = i % 100;
     const productId = i % 50;
     
     db.orders.insertOne({
       _id: i,
       customer_id: customerId,
       customer_name: `Customer ${customerId}`,  // Ğ”ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
       product_id: productId,
       product_name: `Product ${productId}`,     // Ğ”ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
       product_price: Math.floor(Math.random() * 1000),
       quantity: Math.floor(Math.random() * 10) + 1,
       order_date: new Date()
     })
   }
   ```

4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹:
   ```javascript
   // ĞĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
   db.customers.createIndex({ email: 1 })
   db.products.createIndex({ category: 1, price: 1 })
   db.orders.createIndex({ customer_id: 1, order_date: -1 })
   db.orders.createIndex({ product_id: 1 })
   
   // ĞŸĞ¾ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ñ‡Ğ°ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
   db.orders.createIndex({ 
     customer_id: 1, 
     order_date: -1, 
     product_name: 1, 
     quantity: 1 
   })
   
   // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
   db.orders.find(
     { customer_id: 50 },
     { product_name: 1, quantity: 1, order_date: 1, _id: 0 }
   ).sort({ order_date: -1 }).explain("executionStats")
   ```

5. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ:
   ```javascript
   // âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ğ±ĞµĞ· Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ² Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
   db.orders.aggregate([
     { $group: { _id: "$product_id", total: { $sum: "$quantity" } } }
   ])
   
   // âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ñ Ñ€Ğ°Ğ½Ğ½ĞµĞ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¸ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ¼
   db.orders.createIndex({ order_date: 1, product_id: 1 })
   
   db.orders.aggregate([
     { 
       $match: { 
         order_date: { $gte: new Date("2024-01-01") } 
       } 
     },
     { 
       $group: { 
         _id: "$product_id", 
         total: { $sum: "$quantity" } 
       } 
     },
     { $sort: { total: -1 } },
     { $limit: 10 }
   ])
   ```

### ğŸš€ Ğ‘Ğ¾Ğ½ÑƒÑ (Ğ½Ğ¾Ğ²Ğ¾Ğµ)

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Change Streams Ğ´Ğ»Ñ Ñ€ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹:**
```javascript
// ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ¹ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
const changeStream = db.orders.watch([
  { $match: { 'fullDocument.total': { $gte: 1000 } } }
]);

changeStream.on('change', (change) => {
  console.log('High value order:', change.fullDocument);
  // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ, Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸ ĞºÑÑˆ Ğ¸ Ñ‚.Ğ´.
});

// Ğ¡ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
const pipeline = [
  { $match: { 
    'operationType': { $in: ['insert', 'update'] },
    'fullDocument.status': 'pending'
  }}
];

db.orders.watch(pipeline);
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Collation Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸:**
```javascript
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ñ collation
db.createCollection("users", {
  collation: { locale: "ru", strength: 2 }
})

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ñ ÑƒÑ‡ĞµÑ‚Ğ¾Ğ¼ ÑĞ·Ñ‹ĞºĞ°
db.users.find().sort({ name: 1 }).collation({ locale: "ru" })

// Ğ˜Ğ½Ğ´ĞµĞºÑ Ñ collation
db.users.createIndex(
  { name: 1 },
  { collation: { locale: "ru", strength: 2 } }
)
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Capped Collections Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ²:**
```javascript
// ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ Ñ„Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° (FIFO)
db.createCollection("logs", {
  capped: true,
  size: 100000000,  // 100MB
  max: 10000        // ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
})

// ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑƒĞ´Ğ°Ğ»ÑÑÑ‚ÑÑ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹
db.logs.insertOne({ message: "Log entry", timestamp: new Date() })

// Tailable cursor (ĞºĞ°Ğº tail -f)
const cursor = db.logs.find().tailable().awaitData();
```

---

## Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ (60 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°: Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ production-ready Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ğ¼Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚-Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ° Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ Ñ†Ğ¸ĞºĞ»Ğ¾Ğ¼:

**ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°:**
- MongoDB Replica Set (3 ÑƒĞ·Ğ»Ğ°)
- Sharded ĞºĞ»Ğ°ÑÑ‚ĞµÑ€ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ±ÑĞºĞ°Ğ¿Ñ‹
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ (Prometheus + Grafana)
- Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ (Ñ€Ğ¾Ğ»Ğ¸, TLS)

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**

1. **Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:**
   - 4 ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸: customers, products, orders, order_items
   - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑÑ…ĞµĞ¼Ğ° Ñ Ğ´ĞµĞ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹
   - Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

2. **Replica Set:**
   - 3 ÑƒĞ·Ğ»Ğ° (Primary + 2 Secondary)
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ ÑĞ±Ğ¾Ğµ
   - Read preference Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸

3. **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ:**
   - 3 Ñ€Ğ¾Ğ»Ğ¸: admin, app_user, analyst
   - Ğ Ğ°Ğ·Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°
   - ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°

4. **Backup:**
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
   - Retention 7 Ğ´Ğ½ĞµĞ¹
   - Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

5. **ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³:**
   - Prometheus exporter
   - Grafana Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´
   - ĞĞ»ĞµÑ€Ñ‚Ñ‹ Ğ½Ğ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸

6. **API Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸:**
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° (Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ)
   - ĞŸĞ¾Ğ¸ÑĞº Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² Ñ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸ĞµĞ¹
   - ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶ (aggregation)
   - ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ¿Ğ¾ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:**
```
mongodb-ecommerce/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ init-replica-set.js
â”‚   â”œâ”€â”€ create-users.js
â”‚   â”œâ”€â”€ seed-data.js
â”‚   â”œâ”€â”€ backup.sh
â”‚   â””â”€â”€ restore.sh
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ mongod.conf
â”‚   â””â”€â”€ prometheus.yml
â”œâ”€â”€ queries/
â”‚   â”œâ”€â”€ create-order.js
â”‚   â”œâ”€â”€ analytics.js
â”‚   â””â”€â”€ reports.js
â””â”€â”€ README.md
```

**ĞĞ°Ñ‡Ğ½Ğ¸ Ñ Docker Compose:**
```yaml
version: '3.8'

services:
  mongo1:
    image: mongo:7.0
    container_name: mongo1
    command: mongod --replSet rs0 --port 27017 --auth --keyFile /etc/mongodb-keyfile
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: SecurePassword123!
    ports:
      - "27017:27017"
    volumes:
      - mongo1_data:/data/db
      - ./config/mongodb-keyfile:/etc/mongodb-keyfile
    networks:
      - mongo_cluster

  mongo2:
    image: mongo:7.0
    container_name: mongo2
    command: mongod --replSet rs0 --port 27017 --auth --keyFile /etc/mongodb-keyfile
    ports:
      - "27018:27017"
    volumes:
      - mongo2_data:/data/db
      - ./config/mongodb-keyfile:/etc/mongodb-keyfile
    networks:
      - mongo_cluster

  mongo3:
    image: mongo:7.0
    container_name: mongo3
    command: mongod --replSet rs0 --port 27017 --auth --keyFile /etc/mongodb-keyfile
    ports:
      - "27019:27017"
    volumes:
      - mongo3_data:/data/db
      - ./config/mongodb-keyfile:/etc/mongodb-keyfile
    networks:
      - mongo_cluster

  mongodb-exporter:
    image: percona/mongodb_exporter:0.40
    container_name: mongodb-exporter
    command:
      - '--mongodb.uri=mongodb://admin:SecurePassword123!@mongo1:27017'
      - '--collect-all'
    ports:
      - "9216:9216"
    networks:
      - mongo_cluster
    depends_on:
      - mongo1

volumes:
  mongo1_data:
  mongo2_data:
  mongo3_data:

networks:
  mongo_cluster:
    driver: bridge
```

**Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾):**
- CI/CD Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½ Ğ´Ğ»Ñ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Kubernetes
- Connection pooling Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- Automated failover Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- Load testing Ñ k6
- Blue-Green deployment ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ
- Disaster recovery Ğ¿Ğ»Ğ°Ğ½
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ API

---

## Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ°Ñ ÑĞµĞºÑ†Ğ¸Ñ: Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ ÑˆĞ¿Ğ°Ñ€Ğ³Ğ°Ğ»ĞºĞ¸

### MongoDB Shell Commands

```javascript
// Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
show dbs
use mydb
show collections
db.dropDatabase()

// CRUD
db.collection.insertOne({})
db.collection.find({})
db.collection.updateOne({}, { $set: {} })
db.collection.deleteOne({})

// Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹
db.collection.createIndex({ field: 1 })
db.collection.getIndexes()
db.collection.dropIndex("index_name")

// Aggregation
db.collection.aggregate([
  { $match: {} },
  { $group: {} },
  { $sort: {} }
])

// ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
db.serverStatus()
db.stats()
rs.status()
sh.status()
```

### ĞĞ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

```javascript
// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ
$eq, $ne, $gt, $gte, $lt, $lte, $in, $nin

// Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ
$and, $or, $not, $nor

// Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹
$exists, $type

// ĞœĞ°ÑÑĞ¸Ğ²Ñ‹
$all, $elemMatch, $size

// ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
$set, $unset, $inc, $mul, $rename, $push, $pull, $addToSet

// Aggregation
$match, $group, $project, $sort, $limit, $skip, $lookup, $unwind
```

### Connection Strings

```bash
# Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹
mongodb://localhost:27017/mydb

# Ğ¡ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
mongodb://user:pass@localhost:27017/mydb?authSource=admin

# Replica Set
mongodb://host1:27017,host2:27017,host3:27017/mydb?replicaSet=rs0

# Sharded Cluster
mongodb://mongos1:27017,mongos2:27017/mydb

# MongoDB Atlas
mongodb+srv://user:pass@cluster.mongodb.net/mydb
```

### ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

```bash
# mongodump/mongorestore
mongodump --uri="mongodb://localhost:27017" --out=/backup
mongorestore --uri="mongodb://localhost:27017" /backup

# mongoexport/mongoimport
mongoexport --uri="mongodb://localhost:27017" --db=mydb --collection=users --out=users.json
mongoimport --uri="mongodb://localhost:27017" --db=mydb --collection=users --file=users.json

# mongostat/mongotop
mongostat --uri="mongodb://localhost:27017" 5
mongotop --uri="mongodb://localhost:27017" 5
```

---

## Ğ§ĞµĞº-Ğ»Ğ¸ÑÑ‚ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²

ĞŸĞ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ ĞºÑƒÑ€ÑĞ° Ñ‚Ñ‹ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑƒĞ¼ĞµÑ‚ÑŒ:

### Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ MongoDB
- âœ… Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒ CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾
- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
- âœ… ĞŸĞ¸ÑĞ°Ñ‚ÑŒ aggregation pipelines
- âœ… Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ñ mongosh

### ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ Replica Set
- âœ… ĞŸÑ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑÑ…ĞµĞ¼Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ğ¸
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ (RBAC)
- âœ… Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒ Ğ±ÑĞºĞ°Ğ¿Ñ‹ Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
- âœ… ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

### Expert Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ Sharded Cluster
- âœ… ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- âœ… Troubleshooting ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ (Prometheus/Grafana)
- âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Transactions
- âœ… Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ñ Change Streams

---

## Ğ§Ñ‚Ğ¾ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ² Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ñ… Ğ²ĞµÑ€ÑĞ¸ÑÑ… MongoDB

**MongoDB 7.0 (2023):**
- Queryable Encryption GA
- Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Time Series
- Compound Wildcard Indexes
- Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ Change Streams

**MongoDB 6.0 (2022):**
- Clustered Collections
- Time Series Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- Encrypted at Rest ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ

**MongoDB 5.0 (2021):**
- Time Series Collections
- Native Time Series Functions
- Versioned API
- Window Functions Ğ² aggregation

**MongoDB 8.0+ (upcoming):**
- Ğ¡Ğ»ĞµĞ´Ğ¸ Ğ·Ğ° release notes Ğ½Ğ° mongodb.com

---

## Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑÑ! Ğ¢Ñ‹ Ğ¿Ñ€Ğ¾ÑˆĞµĞ» ĞºÑƒÑ€Ñ Ğ¿Ğ¾ Ğ¾ÑĞ²ĞµĞ¶ĞµĞ½Ğ¸Ñ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ MongoDB.

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸:**
1. ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒĞ¹ÑÑ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ MongoDB Ğ² ÑĞ²Ğ¾Ğ¸Ñ… Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ñ…
2. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ backup Ğ¸ monitoring
3. Ğ˜Ğ·ÑƒÑ‡Ğ¸ ÑĞ¼ĞµĞ¶Ğ½Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸: Mongoose, Motor, Redis
4. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸ ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ MongoDB Professional
5. Ğ”ĞµĞ»Ğ¸ÑÑŒ Ğ·Ğ½Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸ - Ğ¿Ğ¸ÑˆĞ¸ Ğ¿Ğ¾ÑÑ‚Ñ‹, Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ğ¹ Ğ½Ğ¾Ğ²Ğ¸Ñ‡ĞºĞ°Ğ¼

**ĞŸĞ¾Ğ¼Ğ½Ğ¸:**
- MongoDB - Ğ¼Ğ¾Ñ‰Ğ½Ñ‹Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
- ĞĞ°Ñ‡Ğ¸Ğ½Ğ°Ğ¹ Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ³Ğ¾, ÑƒÑĞ»Ğ¾Ğ¶Ğ½ÑĞ¹ Ğ¿Ğ¾ÑÑ‚ĞµĞ¿ĞµĞ½Ğ½Ğ¾
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ - Ñ‚Ğ²Ğ¾Ğ¹ Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¹ Ğ´Ñ€ÑƒĞ³
- Community Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ´Ñ€ÑƒĞ¶ĞµĞ»ÑĞ±Ğ½Ğ¾Ğµ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ
- Replica Set Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½ Ğ´Ğ»Ñ production
- Ğ‘ÑĞºĞ°Ğ¿Ñ‹ - ÑÑ‚Ğ¾ ÑĞ²ÑÑ‚Ğ¾Ğµ!

ĞŸÑ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸ ÑÑ‚Ğ¾Ñ‚ ĞºÑƒÑ€Ñ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 6-12 Ğ¼ĞµÑÑÑ†ĞµĞ², Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¾ÑÑ‚Ğ°Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğµ!

**Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹:**
- **MongoDB University** - Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ñ‹Ğµ ĞºÑƒÑ€ÑÑ‹
- **MongoDB Documentation** - Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
- **MongoDB Blog** - Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸ Ğ¸ Ğ»ÑƒÑ‡ÑˆĞ¸Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
- **MongoDB Community Forums** - Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ°
- **Stack Overflow** - Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹
- **GitHub** - Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹

Happy MongoDB learning! ğŸƒğŸš€
